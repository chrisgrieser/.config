# yaml-language-server: $schema=../schemas/espanso-match-schema.json
#───────────────────────────────────────────────────────────────────────────────

matches:
  # `,,lang,,` will create a code block of the respective language and prefill
  # it with the clipboard content, e.g. `,,js,,`
  - regex: ",,(?P<lang>\\w*),,"
    replace: |-
      ```{{lang}}
      {{dedentedCode}}
      ```
    label: Markdown Codeblock
    vars:
      - name: dedentedCode
        type: shell
        params:
          # LC_CTYPE: fix encoding issues
          # awk: remove trailing blank lines
          # python3: remove indentation
          cmd: |
            export LC_CTYPE="en_US.UTF-8"
            pbpaste | 
              awk "NF {p=1} p" | 
              python3 -c "import textwrap,sys; print(textwrap.dedent(sys.stdin.read()))"
  - trigger: LLL
    replace: '[$|$]({{url}})'
    label: Markdown Link
    vars:
      - name: url
        type: shell
        params:
          # only pastes clipboard content if it's a URL
          cmd: '[[ "$(pbpaste)" =~ ^http.* ]] && pbpaste || echo ""'
  #─────────────────────────────────────────────────────────────────────────────
  - trigger: '!table'
    replace: |
      ::: {custom-style="Table Caption"}
      Table $|$:
      :::
    label: Pandoc Table Caption
  - trigger: '!img'
    replace: '<img width=60% alt="" src="$|$">'
    label: HTML Image
