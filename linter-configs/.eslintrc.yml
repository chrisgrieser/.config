# yamllint disable rule:truthy
#───────────────────────────────────────────────────────────────────────────────
extends: [eslint:recommended]
root: true # stop annoying deprecation warning
ignorePatterns: ["!.*", "node_modules"] # Lint files in dotfolder https://github.com/eslint/eslint/issues/10341#issuecomment-468548031
parserOptions:
  ecmaVersion: 2022 # requires at least 2022 so eslint can parse `await` at top level
  sourceType: module
env:
  node: false
  browser: false

#───────────────────────────────────────────────────────────────────────────────

rules:
  # structure
  complexity: [warn, 15]
  max-depth: [warn, 4]

  # variables
  id-length: 
    - warn
    - min: 4
      max: 25
      properties: never
      exceptions: [x, y, i, j, id, min, max, app]
  no-shadow:
    - warn
    - builtinGlobals: true
      hoist: all
  no-unused-vars: warn # typescript already checks for this
  camelcase:
    - warn
    - properties: always
      ignoreImports: true
  no-var: error
  prefer-const: warn
  sort-vars: warn
  no-use-before-define: warn
  no-multi-assign: error
  no-sequences: error
  no-undefined: error
  one-var-declaration-per-line:
    - warn
    - initializations

  # spaces
  func-call-spacing: warn
  no-mixed-spaces-and-tabs: warn
  no-multi-spaces: warn
  array-bracket-spacing: warn
  space-before-blocks: warn
  semi-spacing: warn
  no-whitespace-before-property: warn
  no-empty: warn
  arrow-spacing: warn
  keyword-spacing: warn
  spaced-comment:
    - warn
    - always
    - exceptions: ["-", "_", "─"]

  # new lines
  object-curly-newline:
    - warn
    - multiline: true
  newline-per-chained-call:
    - warn
    - ignoreChainWithDepth: 2

  # Async & Await
  require-await: error
  no-await-in-loop: error
  require-atomic-updates: error

  # Functions
  no-empty-function: warn
  array-callback-return:
    - error
    - checkForEach: false
      allowImplicit: true
  no-useless-return: warn
  func-names: warn
  func-style: 
    - warn
    - declaration

  # Parenthesis
  no-extra-parens:
    - warn
    - all
    - returnAssign: false

  # Loops
  no-unmodified-loop-condition: error
  no-unreachable-loop: error

  # Semicolon
  no-extra-semi: warn
  semi-style:
    - warn
    - last

  # Commas
  comma-spacing: warn
  comma-style: warn
  quotes:
    - warn
    - double
    - avoidEscape: true
      allowTemplateLiterals: true

  # Imports
  no-duplicate-imports: warn
  sort-imports: warn
  dot-notation: error

  # Strings & Regex
  no-useless-concat: warn
  no-multi-str: error
  prefer-regex-literals:
    - error
    - disallowRedundantWrapping: true


  # Numbers
  no-magic-numbers:
    - warn
    # prettier-ignore
    - ignore: [-10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 0.1, 0.2, 0.5, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 100, 1000]
      ignoreArrayIndexes: true
      ignoreDefaultValues: true
  no-floating-decimal: warn
  no-implicit-coercion: error

  # Conditions
  eqeqeq: error
  no-eq-null: warn
  no-negated-condition: error
  no-unneeded-ternary: warn
  no-nested-ternary: error
  yoda: warn
  no-else-return:
    - warn
    - allowElseIf: true
  no-lonely-if: warn
  no-mixed-operators:
    - error
    - groups:
        - ["%", "**"]
        - ["&", "|", ^, "~", <<, ">>", ">>>"]
        - [==, "!=", ===, "!==", ">", ">=", <, <=]
        - ["&&", "||"]
        - [in, instanceof]

#───────────────────────────────────────────────────────────────────────────────

globals:
  # JXA
  ObjC: readonly
  delay: readonly
  Application: readonly
  $: readonly
  Set: readonly
  Path: readonly

  # Obsidian
  tp: readonly # templater
  request: readonly
