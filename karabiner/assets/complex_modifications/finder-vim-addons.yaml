rules:
  - description: "Addons for Finder-Vim-Mode"
    manipulators:
      # Alfred Custom Move-to Command
      - type: basic
        from:
          key_code: m
          modifiers: {mandatory: [command, shift]}
        to:
          - {key_code: m, modifiers: [command, shift]}
          - set_variable:
              name: FINDER_INSERT_MODE
              value: true
          - set_variable:
              name: FINDER_ALFRED_ACTIVE
              value: true
          - set_notification_message:
              id: insert-notice
              text: "ðŸŽ© ALFRED"
        conditions:
          - type: frontmost_application_if
            bundle_identifiers: [^com\.apple\.finder$]
          - type: variable_unless
            name: FINDER_INSERT_MODE
            value: true
          - type: variable_unless
            name: FINDER_FIND_MODE
            value: true
      # Alfred Custom Clipboard Search
      - type: basic
        from: {key_code: f18}
        to:
          - key_code: f18
          - set_variable:
              name: FINDER_INSERT_MODE
              value: true
          - set_variable:
              name: FINDER_ALFRED_ACTIVE
              value: true
          - set_notification_message:
              id: insert-notice
              text: "ðŸŽ© ALFRED"
          - shell_command: osascript -e "beep"
        conditions:
          - type: frontmost_application_if
            bundle_identifiers: [^com\.apple\.finder$]
          - type: variable_unless
            name: FINDER_ALFRED_MODE
            value: true
          - type: variable_unless
            name: FINDER_INSERT_MODE
            value: true
      # abort Alfred Clipboard
      - type: basic
        from: {key_code: f18}
        to:
          - key_code: f18
          - shell_command: osascript -e "beep beep"
          - set_variable:
              name: FINDER_INSERT_MODE
              value: false
          - set_variable:
              name: FINDER_ALFRED_ACTIVE
              value: false
          - set_notification_message:
              id: insert-notice
              text: ""
        conditions:
          - type: variable_if
            name: FINDER_ALFRED_MODE
            value: true
