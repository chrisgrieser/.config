/*! For license information please see settings.js.LICENSE.txt */
var e={992:(e,t,n)=>{var o,r=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function r(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var a={compressToBase64:function(e){if(null==e)return"";var n=a._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:a._decompress(e.length,32,(function(n){return r(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":a._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=a.compress(e),n=new Uint8Array(2*t.length),o=0,r=t.length;o<r;o++){var i=t.charCodeAt(o);n[2*o]=i>>>8,n[2*o+1]=i%256}return n},decompressFromUint8Array:function(t){if(null==t)return a.decompress(t);for(var n=new Array(t.length/2),o=0,r=n.length;o<r;o++)n[o]=256*t[2*o]+t[2*o+1];var i=[];return n.forEach((function(t){i.push(e(t))})),a.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),a._decompress(e.length,32,(function(t){return r(n,e.charAt(t))})))},compress:function(t){return a._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var o,r,a,i={},l={},s="",c="",d="",p=2,u=3,m=2,f=[],v=0,g=0;for(a=0;a<e.length;a+=1)if(s=e.charAt(a),Object.prototype.hasOwnProperty.call(i,s)||(i[s]=u++,l[s]=!0),c=d+s,Object.prototype.hasOwnProperty.call(i,c))d=c;else{if(Object.prototype.hasOwnProperty.call(l,d)){if(d.charCodeAt(0)<256){for(o=0;o<m;o++)v<<=1,g==t-1?(g=0,f.push(n(v)),v=0):g++;for(r=d.charCodeAt(0),o=0;o<8;o++)v=v<<1|1&r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r>>=1}else{for(r=1,o=0;o<m;o++)v=v<<1|r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r=0;for(r=d.charCodeAt(0),o=0;o<16;o++)v=v<<1|1&r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r>>=1}0==--p&&(p=Math.pow(2,m),m++),delete l[d]}else for(r=i[d],o=0;o<m;o++)v=v<<1|1&r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r>>=1;0==--p&&(p=Math.pow(2,m),m++),i[c]=u++,d=String(s)}if(""!==d){if(Object.prototype.hasOwnProperty.call(l,d)){if(d.charCodeAt(0)<256){for(o=0;o<m;o++)v<<=1,g==t-1?(g=0,f.push(n(v)),v=0):g++;for(r=d.charCodeAt(0),o=0;o<8;o++)v=v<<1|1&r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r>>=1}else{for(r=1,o=0;o<m;o++)v=v<<1|r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r=0;for(r=d.charCodeAt(0),o=0;o<16;o++)v=v<<1|1&r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r>>=1}0==--p&&(p=Math.pow(2,m),m++),delete l[d]}else for(r=i[d],o=0;o<m;o++)v=v<<1|1&r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r>>=1;0==--p&&(p=Math.pow(2,m),m++)}for(r=2,o=0;o<m;o++)v=v<<1|1&r,g==t-1?(g=0,f.push(n(v)),v=0):g++,r>>=1;for(;;){if(v<<=1,g==t-1){f.push(n(v));break}g++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,o){var r,a,i,l,s,c,d,p=[],u=4,m=4,f=3,v="",g=[],h={val:o(0),position:n,index:1};for(r=0;r<3;r+=1)p[r]=r;for(i=0,s=Math.pow(2,2),c=1;c!=s;)l=h.val&h.position,h.position>>=1,0==h.position&&(h.position=n,h.val=o(h.index++)),i|=(l>0?1:0)*c,c<<=1;switch(i){case 0:for(i=0,s=Math.pow(2,8),c=1;c!=s;)l=h.val&h.position,h.position>>=1,0==h.position&&(h.position=n,h.val=o(h.index++)),i|=(l>0?1:0)*c,c<<=1;d=e(i);break;case 1:for(i=0,s=Math.pow(2,16),c=1;c!=s;)l=h.val&h.position,h.position>>=1,0==h.position&&(h.position=n,h.val=o(h.index++)),i|=(l>0?1:0)*c,c<<=1;d=e(i);break;case 2:return""}for(p[3]=d,a=d,g.push(d);;){if(h.index>t)return"";for(i=0,s=Math.pow(2,f),c=1;c!=s;)l=h.val&h.position,h.position>>=1,0==h.position&&(h.position=n,h.val=o(h.index++)),i|=(l>0?1:0)*c,c<<=1;switch(d=i){case 0:for(i=0,s=Math.pow(2,8),c=1;c!=s;)l=h.val&h.position,h.position>>=1,0==h.position&&(h.position=n,h.val=o(h.index++)),i|=(l>0?1:0)*c,c<<=1;p[m++]=e(i),d=m-1,u--;break;case 1:for(i=0,s=Math.pow(2,16),c=1;c!=s;)l=h.val&h.position,h.position>>=1,0==h.position&&(h.position=n,h.val=o(h.index++)),i|=(l>0?1:0)*c,c<<=1;p[m++]=e(i),d=m-1,u--;break;case 2:return g.join("")}if(0==u&&(u=Math.pow(2,f),f++),p[d])v=p[d];else{if(d!==m)return null;v=a+a.charAt(0)}g.push(v),p[m++]=a+v.charAt(0),a=v,0==--u&&(u=Math.pow(2,f),f++)}}};return a}();void 0===(o=function(){return r}.call(t,n,t,e))||(e.exports=o)}},t={};const n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},o=(e,t,n=[])=>{const r=document.createElementNS("http://www.w3.org/2000/svg",e);return Object.keys(t).forEach((e=>{r.setAttribute(e,String(t[e]))})),n.length&&n.forEach((e=>{const t=o(...e);r.appendChild(t)})),r},r=e=>"string"==typeof e?e:e&&e.class?e.class&&"string"==typeof e.class?e.class.split(" "):e.class&&Array.isArray(e.class)?e.class:"":"",a=(e,{nameAttr:t,icons:n,attrs:a})=>{const i=e.getAttribute(t);if(null==i)return;const l=n[i.replace(/(\w)(\w*)(_|-|\s*)/g,((e,t,n)=>t.toUpperCase()+n.toLowerCase()))];if(!l)return console.warn(`${e.outerHTML} icon name was not found in the provided icons object.`);const s=(e=>Array.from(e.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{}))(e),[c,d,p]=l,u={...d,"data-lucide":i,...a,...s},m=["lucide",`lucide-${i}`,s,a].flatMap(r).map((e=>e.trim())).filter(Boolean).filter(((e,t,n)=>n.indexOf(e)===t)).join(" ");m&&Object.assign(u,{class:m});const f=(([e,t,n])=>o(e,t,n))([c,u,p]);return e.parentNode?.replaceChild(f,e)},i=({icons:e={},nameAttr:t="data-lucide",attrs:n={}}={})=>{if(!Object.values(e).length)throw new Error("Please provide an icons object.\nIf you want to use all the icons you can import it like:\n `import { createIcons, icons } from 'lucide';\nlucide.createIcons({icons});`");if("undefined"==typeof document)throw new Error("`createIcons()` only works in a browser environment.");const o=document.querySelectorAll(`[${t}]`);if(Array.from(o).forEach((o=>a(o,{nameAttr:t,icons:e,attrs:n}))),"data-lucide"===t){const t=document.querySelectorAll("[icon-name]");t.length>0&&(console.warn("[Lucide] Some icons were found with the now deprecated icon-name attribute. These will still be replaced for backwards compatibility, but will no longer be supported in v1.0 and you should switch to data-lucide"),Array.from(t).forEach((t=>a(t,{nameAttr:"icon-name",icons:e,attrs:n}))))}},l={Trash2:["svg",n,[["path",{d:"M3 6h18"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17"}]]],AlignLeft:["svg",n,[["line",{x1:"21",x2:"3",y1:"6",y2:"6"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18"}]]],Binary:["svg",n,[["rect",{x:"14",y:"14",width:"4",height:"6",rx:"2"}],["rect",{x:"6",y:"4",width:"4",height:"6",rx:"2"}],["path",{d:"M6 20h4"}],["path",{d:"M14 10h4"}],["path",{d:"M6 14h2v6"}],["path",{d:"M14 4h2v6"}]]],List:["svg",n,[["line",{x1:"8",x2:"21",y1:"6",y2:"6"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18"}]]],Calendar:["svg",n,[["path",{d:"M8 2v4"}],["path",{d:"M16 2v4"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M3 10h18"}]]],Clock:["svg",n,[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 16 14"}]]],SquareCheckBig:["svg",n,[["path",{d:"m9 11 3 3L22 4"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"}]]],GripVertical:["svg",n,[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]]],Settings:["svg",n,[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]]]};function s(e=document){i({icons:l,attrs:{"stroke-width":1.75,class:"lucide-icon"},nameAttr:"data-lucide"})}function c(e){return{text:"align-left",multitext:"list",number:"binary",checkbox:"square-check-big",date:"calendar",datetime:"clock"}[e]||"align-left"}let d=[];function p(){const e=document.getElementById("vault-list");e.innerHTML="",d.forEach(((t,n)=>{const o=document.createElement("li");o.innerHTML=`\n\t\t\t<div class="drag-handle">\n\t\t\t\t<i data-lucide="grip-vertical"></i>\n\t\t\t</div>\n\t\t\t<span>${t}</span>\n\t\t\t<button type="button" class="remove-vault-btn clickable-icon" aria-label="Remove vault">\n\t\t\t\t<i data-lucide="trash-2"></i>\n\t\t\t</button>\n\t\t`,o.dataset.index=n.toString(),o.draggable=!0,o.addEventListener("dragstart",v),o.addEventListener("dragover",g),o.addEventListener("drop",h),o.addEventListener("dragend",y),o.querySelector(".remove-vault-btn").addEventListener("click",(e=>{e.stopPropagation(),function(e){d.splice(e,1),m(),p()}(n)})),e.appendChild(o)})),s(e)}function u(){return d}function m(){return new Promise(((e,t)=>{chrome.storage.sync.set({vaults:d},(()=>{chrome.runtime.lastError?(console.error("Error saving vaults:",chrome.runtime.lastError),t(chrome.runtime.lastError)):(console.log("General settings saved"),e())}))}))}let f=null;function v(e){e.stopPropagation(),f=e.target.closest("[draggable]"),f&&e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",f.dataset.id||f.dataset.index||""),setTimeout((()=>{f&&f.classList.add("dragging")}),0))}function g(e){var t,n;e.stopPropagation(),e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");const o=e.target.closest("[draggable]");if(o&&o!==f&&f){const r=o.getBoundingClientRect(),a=r.top+r.height/2;e.clientY<a?null===(t=o.parentNode)||void 0===t||t.insertBefore(f,o):null===(n=o.parentNode)||void 0===n||n.insertBefore(f,o.nextSibling)}}function h(e){if(e.stopPropagation(),e.preventDefault(),!e.dataTransfer)return;const t=e.dataTransfer.getData("text/plain"),n=e.target.closest("ul, #template-properties");if(n&&f){const e=Array.from(n.children).indexOf(f);"template-list"===n.id?function(e,t){const n=$(),o=n.findIndex((t=>t.id===e));if(-1!==o&&o!==t){const[e]=n.splice(o,1);n.splice(t,0,e),P().then((()=>{M()})).catch((e=>{console.error("Failed to save template settings:",e)}))}}(t,e):"template-properties"===n.id?function(e,t){const n=q();if(-1===n)return void console.error("No template is currently being edited");const o=$()[n];if(!o)return void console.error("Template not found");if(!Array.isArray(o.properties)||0===o.properties.length)return void console.error("Template properties array is empty or not an array");const r=o.properties.findIndex((t=>t.id===e));if(-1!==r){if(r!==t){const[e]=o.properties.splice(r,1);o.properties.splice(t,0,e),P().then((()=>{M()})).catch((e=>{console.error("Failed to save template settings:",e)}))}}else console.error("Property not found")}(t,e):"vault-list"===n.id&&function(e){const t=u();if(!f)return;const n=parseInt(f.dataset.index||"-1");if(-1!==n&&n!==e){const[o]=t.splice(n,1);t.splice(e,0,o),m().then((()=>{p()})).catch((e=>{console.error("Failed to save general settings:",e)}))}}(e),f.classList.remove("dragging")}f=null}function y(){f&&f.classList.remove("dragging"),f=null}var E=function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}(992),b=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}))};let w=[],x=-1;const L="template_",I="template_list",A=8e3,B=6e3;let S=!1;function k(e){return b(this,void 0,void 0,(function*(){return new Promise((t=>{chrome.storage.sync.get(L+e,(n=>{const o=n[L+e];if(o){const e=(0,E.decompressFromUTF16)(o.join(""));t(JSON.parse(e))}else t(null)}))}))}))}function M(){const e=document.getElementById("template-list");e&&(e.innerHTML="",w.forEach(((t,n)=>{if(t&&t.name&&t.id){const o=document.createElement("li");o.innerHTML=`\n\t\t\t\t<div class="drag-handle">\n\t\t\t\t\t<i data-lucide="grip-vertical"></i>\n\t\t\t\t</div>\n\t\t\t\t<span class="template-name">${t.name}</span>\n\t\t\t\t<button type="button" class="delete-template-btn clickable-icon" aria-label="Delete template">\n\t\t\t\t\t<i data-lucide="trash-2"></i>\n\t\t\t\t</button>\n\t\t\t`,o.dataset.id=t.id,o.dataset.index=n.toString(),o.draggable=!0,o.addEventListener("click",(e=>{e.target.closest(".delete-template-btn")||T(t)}));const r=o.querySelector(".delete-template-btn");r&&r.addEventListener("click",(e=>{e.stopPropagation(),function(e){const t=w.findIndex((t=>t.id===e));if(-1!==t&&confirm(`Are you sure you want to delete the template "${w[t].name}"?`)){if(w.splice(t,1),x===t)if(w.length>0){const e=Math.max(0,t-1);T(w[e])}else!function(){x=-1;const e=document.getElementById("template-editor-title"),t=document.getElementById("template-name"),n=document.getElementById("template-properties");e&&(e.textContent="New template"),t&&(t.value=""),n&&(n.innerHTML="");const o=document.getElementById("template-path-name");o&&(o.value="Clippings");const r=document.getElementById("url-patterns");r&&(r.value="");const a=document.getElementById("template-editor");a&&(a.style.display="none")}();else x>t&&x--;P(),M()}}(t.id)})),n===x&&o.classList.add("active"),e.appendChild(o)}else console.error("Invalid template at index",n,":",t)})),s(e))}function T(e){let t;e?(t=e,x=w.findIndex((e=>e.id===t.id))):(t={id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"New template",behavior:"create",noteNameFormat:"{{title}}",path:"Clippings",noteContentFormat:"{{content}}",properties:[],urlPatterns:[]},w.push(t),x=w.length-1,P().then((()=>{M()})).catch((e=>{console.error("Failed to save new template:",e)}))),t.properties||(t.properties=[]);const n=document.getElementById("template-editor-title"),o=document.getElementById("template-name"),r=document.getElementById("template-properties");n&&(n.textContent="Edit template"),o&&(o.value=t.name),r&&(r.innerHTML="");const a=document.getElementById("template-path-name");a&&(a.value=t.path);const i=document.getElementById("template-behavior");document.getElementById("specific-note-container"),document.getElementById("daily-note-format-container"),document.getElementById("note-name-format-container"),document.getElementById("properties-container"),document.getElementById("properties-warning"),i&&(i.value=t.behavior||"create");const l=document.getElementById("specific-note-name");l&&(l.value=t.specificNoteName||"");const s=document.getElementById("daily-note-format");s&&(s.value=t.dailyNoteFormat||"YYYY-MM-DD");const c=document.getElementById("note-name-format");c&&(c.value=t.noteNameFormat||"{{title}}");const d=document.getElementById("note-content-format");d&&(d.value=t.noteContentFormat||""),U(),i&&i.addEventListener("change",U),t&&Array.isArray(t.properties)&&t.properties.forEach((e=>D(e.name,e.value,e.type,e.id)));const p=document.getElementById("url-patterns");p&&(p.value=t&&t.urlPatterns?t.urlPatterns.join("\n"):"");const u=document.getElementById("template-editor");u&&(u.style.display="block");const m=document.getElementById("templates-section");m&&(m.style.display="block");const f=document.getElementById("general-section");if(f&&(f.style.display="none"),document.querySelectorAll(".sidebar li[data-section]").forEach((e=>e.classList.remove("active"))),document.querySelectorAll("#template-list li").forEach((e=>e.classList.remove("active"))),-1!==x){const e=document.querySelector(`#template-list li[data-id="${w[x].id}"]`);e&&e.classList.add("active")}if(m&&m.classList.add("active"),f&&f.classList.remove("active"),M(),!t.id){const e=document.getElementById("template-name");e&&(e.focus(),e.select())}N(),o&&o.addEventListener("input",function(e){let t=null;return function(...n){const o=this;t&&clearTimeout(t),t=setTimeout((()=>e.apply(o,n)),200)}}((()=>{-1!==x&&w[x]&&(w[x].name=o.value,M(),S=!0)}))),S=!0}function C(e){return b(this,void 0,void 0,(function*(){const t=(0,E.compressToUTF16)(JSON.stringify(e)),n=[];for(let e=0;e<t.length;e+=A)n.push(t.slice(e,e+A));return t.length>B?[n,`Warning: Template "${e.name}" is ${(t.length/1024).toFixed(2)}KB, which is approaching the storage limit.`]:[n,null]}))}function P(){return new Promise(((e,t)=>b(this,void 0,void 0,(function*(){try{const n=w.map((e=>e.id)),o=[],r={};for(const e of w){const[t,n]=yield C(e);r[L+e.id]=t,n&&o.push(n)}chrome.storage.sync.set(Object.assign(Object.assign({},r),{[I]:n}),(()=>{chrome.runtime.lastError?(console.error("Error saving templates:",chrome.runtime.lastError),t(chrome.runtime.lastError)):(console.log("Template settings saved"),S=!1,e(o))}))}catch(e){console.error("Error preparing templates for save:",e),t(e)}}))))}function F(){return{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"Default",behavior:"create",noteNameFormat:"{{title}}",path:"Clippings",noteContentFormat:"{{content}}",properties:[{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"title",value:"{{title}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"source",value:"{{url}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"author",value:"{{author|wikilink}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"published",value:"{{published}}",type:"date"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"created",value:"{{date}}",type:"date"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"description",value:"{{description}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"tags",value:"clippings",type:"multitext"}],urlPatterns:[]}}function D(e="",t="",n="text",o=null){const r=document.getElementById("template-properties");if(!r)return;const a=document.createElement("div");var i;a.className="property-editor",a.innerHTML=`\n\t\t<div class="drag-handle">\n\t\t\t<i data-lucide="grip-vertical"></i>\n\t\t</div>\n\t\t<div class="property-select">\n\t\t\t<div class="property-selected" data-value="${n}">\n\t\t\t\t<i data-lucide="${c(n)}"></i>\n\t\t\t</div>\n\t\t\t<select class="property-type">\n\t\t\t\t<option value="text">Text</option>\n\t\t\t\t<option value="multitext">List</option>\n\t\t\t\t<option value="number">Number</option>\n\t\t\t\t<option value="checkbox">Checkbox</option>\n\t\t\t\t<option value="date">Date</option>\n\t\t\t\t<option value="datetime">Date & time</option>\n\t\t\t</select>\n\t\t</div>\n\t\t<input type="text" class="property-name" value="${e}" placeholder="Property name">\n\t\t<input type="text" class="property-value" value="${i=function(e){return e.replace(/\\"/g,'"').replace(/\\n/g,"\n")}(t),i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}" placeholder="Property value">\n\t\t<button type="button" class="remove-property-btn clickable-icon" aria-label="Remove property">\n\t\t\t<i data-lucide="trash-2"></i>\n\t\t</button>\n\t`,a.dataset.id=o||Date.now().toString()+Math.random().toString(36).slice(2,11),r.appendChild(a),a.addEventListener("mousedown",(e=>{e.target.closest("input, select, button")||(a.setAttribute("draggable","true"),r.querySelectorAll(".property-editor").forEach((e=>{e!==a&&e.setAttribute("draggable","true")})))}));const l=()=>{a.removeAttribute("draggable"),r.querySelectorAll(".property-editor").forEach((e=>{e.removeAttribute("draggable")}))};a.addEventListener("dragend",l),a.addEventListener("mouseup",l);const d=a.querySelector(".property-select");if(!d)return;const p=d.querySelector(".property-selected"),u=d.querySelector("select");u&&(u.value=n,u.addEventListener("change",(function(){p&&O(this.value,p)})));const m=a.querySelector(".remove-property-btn");m&&m.addEventListener("click",(()=>{r.removeChild(a)})),a.addEventListener("dragstart",v),a.addEventListener("dragover",g),a.addEventListener("drop",h),a.addEventListener("dragend",y),p&&O(n,p),s(a)}function O(e,t){const n=c(e);t.innerHTML=`<i data-lucide="${n}"></i>`,t.setAttribute("data-value",e),s(t)}function j(){if(-1===x)return;const e=w[x];if(!e)return void console.error("Template not found");const t=document.getElementById("template-behavior");t&&(e.behavior=t.value);const n=document.getElementById("template-path-name");n&&(e.path=n.value);const o=document.getElementById("note-name-format");o&&(e.noteNameFormat=o.value);const r=document.getElementById("specific-note-name");r&&(e.specificNoteName=r.value);const a=document.getElementById("daily-note-format");a&&(e.dailyNoteFormat=a.value);const i=document.getElementById("note-content-format");i&&(e.noteContentFormat=i.value);const l=document.querySelectorAll("#template-properties .property-editor");e.properties=Array.from(l).map((e=>{const t=e.querySelector(".property-name"),n=e.querySelector(".property-value"),o=e.querySelector(".property-select .property-selected");return{id:e.dataset.id||Date.now().toString()+Math.random().toString(36).slice(2,11),name:t.value,value:(r=n.value,r.replace(/"/g,'\\"').replace(/\n/g,"\\n")),type:o.getAttribute("data-value")||"text"};var r}));const s=document.getElementById("url-patterns");s&&(e.urlPatterns=s.value.split("\n").filter(Boolean)),S=!0}function N(){S=!1}function q(){return x}function $(){return w}function U(){const e=document.getElementById("template-behavior"),t=document.getElementById("specific-note-container"),n=document.getElementById("daily-note-format-container"),o=document.getElementById("note-name-format-container"),r=document.getElementById("properties-container"),a=document.getElementById("properties-warning");if(e){const i=e.value;t&&(t.style.display="append-specific"===i?"block":"none"),n&&(n.style.display="append-daily"===i?"block":"none"),o&&(o.style.display="create"===i?"block":"none"),"append-specific"===i||"append-daily"===i?(r&&(r.style.display="none"),a&&(a.style.display="block")):(r&&(r.style.display="block"),a&&(a.style.display="none"))}}function _(){const e=document.getElementById("template-settings-form");if(!e)return void console.error("Template form not found");const t=(e=>{let t=null;return function(...n){const o=this;t&&clearTimeout(t),t=setTimeout((()=>e.apply(o,n)),1e3)}})((()=>{return e=this,t=void 0,o=function*(){try{const e=yield P();e.length>0&&(M(),console.log("Auto-save completed"),function(e){console.warn(e.join("\n"))}(e))}catch(e){console.error("Auto-save failed:",e)}},new((n=void 0)||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function l(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}));var e,t,n,o}));e.addEventListener("input",(()=>{-1!==x&&(j(),t())}));const n=document.getElementById("template-properties");n&&(n.addEventListener("click",(e=>{const n=e.target;(n.classList.contains("remove-property-btn")||n.closest(".remove-property-btn"))&&-1!==x&&(j(),t())})),n.addEventListener("change",(e=>{e.target.classList.contains("property-type")&&-1!==x&&(j(),t())})));const o=document.getElementById("add-property-btn");o?o.addEventListener("click",(()=>{D(),-1!==x&&(j(),t())})):console.error("Add property button not found")}function H(){if(-1===x)return void alert("Please select a template to export.");const e=w[x],t=`${n=e.name,n.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase()}-clipper.json`;var n;const o={schemaVersion:"0.1.0",name:e.name,behavior:e.behavior,noteNameFormat:e.noteNameFormat,path:e.path,noteContentFormat:e.noteContentFormat,properties:e.properties.map((({name:e,value:t,type:n})=>({name:e,value:t,type:n}))),urlPatterns:e.urlPatterns},r=JSON.stringify(o,null,2),a=new Blob([r],{type:"application/json"}),i=URL.createObjectURL(a),l=document.createElement("a");l.href=i,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)}function R(){const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!n)return;const o=new FileReader;o.onload=e=>{var t,n;try{const o=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);if(!V(o))throw new Error("Invalid template file");o.id=Date.now().toString()+Math.random().toString(36).substr(2,9),o.properties=null===(n=o.properties)||void 0===n?void 0:n.map((e=>Object.assign(Object.assign({},e),{id:Date.now().toString()+Math.random().toString(36).substr(2,9)})));let r=o.name,a=1;for(;w.some((e=>e.name===r));)r=`${o.name} (${a++})`;o.name=r,w.push(o),P(),M(),T(o)}catch(e){console.error("Error parsing imported template:",e),alert("Error importing template. Please check the file and try again.")}},o.readAsText(n)},e.click()}function V(e){const t=["text","multitext","number","checkbox","date","datetime"];return["name","behavior","path","properties","noteContentFormat"].every((t=>e.hasOwnProperty(t)))&&Array.isArray(e.properties)&&e.properties.every((e=>e.hasOwnProperty("name")&&e.hasOwnProperty("value")&&e.hasOwnProperty("type")&&t.includes(e.type)))}function J(e){const t=new FileReader;t.onload=e=>{var t,n;try{const o=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);if(!V(o))throw new Error("Invalid template file");o.id=Date.now().toString()+Math.random().toString(36).substr(2,9),o.properties=null===(n=o.properties)||void 0===n?void 0:n.map((e=>Object.assign(Object.assign({},e),{id:Date.now().toString()+Math.random().toString(36).substr(2,9)})));let r=o.name,a=1;for(;w.some((e=>e.name===r));)r=`${o.name} (${a++})`;o.name=r,w.push(o),P(),M(),T(o)}catch(e){console.error("Error parsing imported template:",e),alert("Error importing template. Please check the file and try again.")}},t.readAsText(e)}function Y(){const e=F(),t=$(),n=t.findIndex((e=>"Default"===e.name));-1!==n?t[n]=e:t.unshift(e),P().then((()=>{M(),T(e)})).catch((e=>{console.error("Failed to reset default template:",e),alert("Failed to reset default template. Please try again.")}))}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("vault-input"),t=document.getElementById("new-template-btn"),n=document.getElementById("export-template-btn"),o=document.getElementById("import-template-btn"),r=document.getElementById("reset-default-template-btn");e?e.addEventListener("keypress",(t=>{if("Enter"===t.key){t.preventDefault();const o=e.value.trim();o&&(n=o,d.push(n),m(),p(),e.value="")}var n})):console.error("Vault input not found"),chrome.storage.sync.get(["vaults"],(e=>{d=e.vaults||[],p()})),function(){return new Promise((e=>{chrome.storage.sync.get(I,(t=>b(this,void 0,void 0,(function*(){const n=t[I]||[];w=[];for(const e of n){const t=yield k(e);t&&w.push(t)}0===w.length&&w.push(F()),M(),w.length>0&&T(w[0]),e()}))))}))}().then((()=>{!function(){const e=document.getElementById("template-list");e?e.addEventListener("click",(e=>{const t=e.target.closest("li");if(t&&t.dataset.id){const e=$().find((e=>e.id===t.dataset.id));e&&(N(),T(e))}})):console.error("Template list not found"),t&&t.addEventListener("click",(()=>{T(null)}))}()})),function(){const e=document.querySelectorAll(".sidebar li[data-section]"),t=document.querySelectorAll(".settings-section");e.forEach((n=>{n.addEventListener("click",(()=>{const o=n.dataset.section;e.forEach((e=>e.classList.remove("active"))),n.classList.add("active"),document.querySelectorAll("#template-list li").forEach((e=>e.classList.remove("active")));const r=document.getElementById("template-editor");r&&(r.style.display="none"),x=-1,t.forEach((e=>{e.id===`${o}-section`?(e.style.display="block",e.classList.add("active")):(e.style.display="none",e.classList.remove("active"))}))}))}))}(),_(),[document.getElementById("template-list"),document.getElementById("template-properties"),document.getElementById("vault-list")].forEach((e=>{e&&(e.addEventListener("dragstart",v),e.addEventListener("dragover",g),e.addEventListener("drop",h),e.addEventListener("dragend",y))})),function(){const e=document.getElementById("template-drop-zone"),t=document.body;if(!e)return void console.error("Drop zone not found");let n=0;function o(e){var t;if(null===(t=e.dataTransfer)||void 0===t?void 0:t.types)for(let t=0;t<e.dataTransfer.types.length;t++)if("Files"===e.dataTransfer.types[t])return!0;return!1}t.addEventListener("dragenter",(function(t){t.preventDefault(),t.stopPropagation(),n++,o(t)&&(null==e||e.classList.add("drag-over"))}),!1),t.addEventListener("dragleave",(function(t){t.preventDefault(),t.stopPropagation(),n--,0===n&&(null==e||e.classList.remove("drag-over"))}),!1),t.addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation()}),!1),t.addEventListener("drop",(function(t){var r;if(t.preventDefault(),t.stopPropagation(),null==e||e.classList.remove("drag-over"),n=0,o(t)){const e=null===(r=t.dataTransfer)||void 0===r?void 0:r.files;e&&e.length&&function(e){Array.from(e).forEach(J)}(e)}}),!1)}(),n.addEventListener("click",H),o.addEventListener("click",R),r.addEventListener("click",Y),i({icons:l})}));