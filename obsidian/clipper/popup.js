/*! For license information please see popup.js.LICENSE.txt */
var e={804:e=>{var t={unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i};function n(e){return(!e.style||"none"!=e.style.display)&&!e.hasAttribute("hidden")&&(!e.hasAttribute("aria-hidden")||"true"!=e.getAttribute("aria-hidden")||e.className&&e.className.indexOf&&-1!==e.className.indexOf("fallback-image"))}e.exports=function(e,r={}){"function"==typeof r&&(r={visibilityChecker:r});var i={minScore:20,minContentLength:140,visibilityChecker:n};r=Object.assign(i,r);var a=e.querySelectorAll("p, pre, article"),o=e.querySelectorAll("div > br");if(o.length){var s=new Set(a);[].forEach.call(o,(function(e){s.add(e.parentNode)})),a=Array.from(s)}var l=0;return[].some.call(a,(function(e){if(!r.visibilityChecker(e))return!1;var n=e.className+" "+e.id;if(t.unlikelyCandidates.test(n)&&!t.okMaybeItsACandidate.test(n))return!1;if(e.matches("li p"))return!1;var i=e.textContent.trim().length;return!(i<r.minContentLength)&&(l+=Math.sqrt(i-r.minContentLength))>r.minScore}))}},238:e=>{function t(e,t){if(t&&t.documentElement)e=t,t=arguments[2];else if(!e||!e.documentElement)throw new Error("First argument to Readability constructor should be a document object.");if(t=t||{},this._doc=e,this._docJSDOMParser=this._doc.firstChild.__JSDOMParser__,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._articleSiteName=null,this._attempts=[],this._debug=!!t.debug,this._maxElemsToParse=t.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=t.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._charThreshold=t.charThreshold||this.DEFAULT_CHAR_THRESHOLD,this._classesToPreserve=this.CLASSES_TO_PRESERVE.concat(t.classesToPreserve||[]),this._keepClasses=!!t.keepClasses,this._serializer=t.serializer||function(e){return e.innerHTML},this._disableJSONLD=!!t.disableJSONLD,this._allowedVideoRegex=t.allowedVideoRegex||this.REGEXPS.videos,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._debug){let e=function(e){if(e.nodeType==e.TEXT_NODE)return`${e.nodeName} ("${e.textContent}")`;let t=Array.from(e.attributes||[],(function(e){return`${e.name}="${e.value}"`})).join(" ");return`<${e.localName} ${t}>`};this.log=function(){if("undefined"!=typeof console){let t=Array.from(arguments,(t=>t&&t.nodeType==this.ELEMENT_NODE?e(t):t));t.unshift("Reader: (Readability)"),console.log.apply(console,t)}else if("undefined"!=typeof dump){var t=Array.prototype.map.call(arguments,(function(t){return t&&t.nodeName?e(t):t})).join(" ");dump("Reader: (Readability) "+t+"\n")}}}else this.log=function(){}}t.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,ELEMENT_NODE:1,TEXT_NODE:3,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),DEFAULT_CHAR_THRESHOLD:500,REGEXPS:{unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/-ad-|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?((dailymotion|youtube|youtube-nocookie|player\.vimeo|v\.qq)\.com|(archive|upload\.wikimedia)\.org|player\.twitch\.tv)/i,shareElements:/(\b|_)(share|sharedaddy)(\b|_)/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,tokenize:/\W+/g,whitespace:/^\s*$/,hasContent:/\S$/,hashUrl:/^#.+/,srcsetUrl:/(\S+)(\s+[\d.]+[xw])?(\s*(?:,|$))/g,b64DataUrl:/^data:\s*([^\s;,]+)\s*;\s*base64\s*,/i,commas:/\u002C|\u060C|\uFE50|\uFE10|\uFE11|\u2E41|\u2E34|\u2E32|\uFF0C/g,jsonLdArticleTypes:/^Article|AdvertiserContentArticle|NewsArticle|AnalysisNewsArticle|AskPublicNewsArticle|BackgroundNewsArticle|OpinionNewsArticle|ReportageNewsArticle|ReviewNewsArticle|Report|SatiricalArticle|ScholarlyArticle|MedicalScholarlyArticle|SocialMediaPosting|BlogPosting|LiveBlogPosting|DiscussionForumPosting|TechArticle|APIReference$/},UNLIKELY_ROLES:["menu","menubar","complementary","navigation","alert","alertdialog","dialog"],DIV_TO_P_ELEMS:new Set(["BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL"]),ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],PRESENTATIONAL_ATTRIBUTES:["align","background","bgcolor","border","cellpadding","cellspacing","frame","hspace","rules","style","valign","vspace"],DEPRECATED_SIZE_ATTRIBUTE_ELEMS:["TABLE","TH","TD","HR","PRE"],PHRASING_ELEMS:["ABBR","AUDIO","B","BDO","BR","BUTTON","CITE","CODE","DATA","DATALIST","DFN","EM","EMBED","I","IMG","INPUT","KBD","LABEL","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PROGRESS","Q","RUBY","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","VAR","WBR"],CLASSES_TO_PRESERVE:["page"],HTML_ESCAPE_MAP:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},_postProcessContent:function(e){this._fixRelativeUris(e),this._simplifyNestedElements(e),this._keepClasses||this._cleanClasses(e)},_removeNodes:function(e,t){if(this._docJSDOMParser&&e._isLiveNodeList)throw new Error("Do not pass live node lists to _removeNodes");for(var n=e.length-1;n>=0;n--){var r=e[n],i=r.parentNode;i&&(t&&!t.call(this,r,n,e)||i.removeChild(r))}},_replaceNodeTags:function(e,t){if(this._docJSDOMParser&&e._isLiveNodeList)throw new Error("Do not pass live node lists to _replaceNodeTags");for(const n of e)this._setNodeTag(n,t)},_forEachNode:function(e,t){Array.prototype.forEach.call(e,t,this)},_findNode:function(e,t){return Array.prototype.find.call(e,t,this)},_someNode:function(e,t){return Array.prototype.some.call(e,t,this)},_everyNode:function(e,t){return Array.prototype.every.call(e,t,this)},_concatNodeLists:function(){var e=Array.prototype.slice,t=e.call(arguments).map((function(t){return e.call(t)}));return Array.prototype.concat.apply([],t)},_getAllNodesWithTag:function(e,t){return e.querySelectorAll?e.querySelectorAll(t.join(",")):[].concat.apply([],t.map((function(t){var n=e.getElementsByTagName(t);return Array.isArray(n)?n:Array.from(n)})))},_cleanClasses:function(e){var t=this._classesToPreserve,n=(e.getAttribute("class")||"").split(/\s+/).filter((function(e){return-1!=t.indexOf(e)})).join(" ");for(n?e.setAttribute("class",n):e.removeAttribute("class"),e=e.firstElementChild;e;e=e.nextElementSibling)this._cleanClasses(e)},_fixRelativeUris:function(e){var t=this._doc.baseURI,n=this._doc.documentURI;function r(e){if(t==n&&"#"==e.charAt(0))return e;try{return new URL(e,t).href}catch(e){}return e}var i=this._getAllNodesWithTag(e,["a"]);this._forEachNode(i,(function(e){var t=e.getAttribute("href");if(t)if(0===t.indexOf("javascript:"))if(1===e.childNodes.length&&e.childNodes[0].nodeType===this.TEXT_NODE){var n=this._doc.createTextNode(e.textContent);e.parentNode.replaceChild(n,e)}else{for(var i=this._doc.createElement("span");e.firstChild;)i.appendChild(e.firstChild);e.parentNode.replaceChild(i,e)}else e.setAttribute("href",r(t))}));var a=this._getAllNodesWithTag(e,["img","picture","figure","video","audio","source"]);this._forEachNode(a,(function(e){var t=e.getAttribute("src"),n=e.getAttribute("poster"),i=e.getAttribute("srcset");if(t&&e.setAttribute("src",r(t)),n&&e.setAttribute("poster",r(n)),i){var a=i.replace(this.REGEXPS.srcsetUrl,(function(e,t,n,i){return r(t)+(n||"")+i}));e.setAttribute("srcset",a)}}))},_simplifyNestedElements:function(e){for(var t=e;t;){if(t.parentNode&&["DIV","SECTION"].includes(t.tagName)&&(!t.id||!t.id.startsWith("readability"))){if(this._isElementWithoutContent(t)){t=this._removeAndGetNext(t);continue}if(this._hasSingleTagInsideElement(t,"DIV")||this._hasSingleTagInsideElement(t,"SECTION")){for(var n=t.children[0],r=0;r<t.attributes.length;r++)n.setAttribute(t.attributes[r].name,t.attributes[r].value);t.parentNode.replaceChild(n,t),t=n;continue}}t=this._getNextNode(t)}},_getArticleTitle:function(){var e=this._doc,t="",n="";try{"string"!=typeof(t=n=e.title.trim())&&(t=n=this._getInnerText(e.getElementsByTagName("title")[0]))}catch(e){}var r=!1;function i(e){return e.split(/\s+/).length}if(/ [\|\-\\\/>»] /.test(t))r=/ [\\\/>»] /.test(t),i(t=n.replace(/(.*)[\|\-\\\/>»] .*/gi,"$1"))<3&&(t=n.replace(/[^\|\-\\\/>»]*[\|\-\\\/>»](.*)/gi,"$1"));else if(-1!==t.indexOf(": ")){var a=this._concatNodeLists(e.getElementsByTagName("h1"),e.getElementsByTagName("h2")),o=t.trim();this._someNode(a,(function(e){return e.textContent.trim()===o}))||(i(t=n.substring(n.lastIndexOf(":")+1))<3?t=n.substring(n.indexOf(":")+1):i(n.substr(0,n.indexOf(":")))>5&&(t=n))}else if(t.length>150||t.length<15){var s=e.getElementsByTagName("h1");1===s.length&&(t=this._getInnerText(s[0]))}var l=i(t=t.trim().replace(this.REGEXPS.normalize," "));return l<=4&&(!r||l!=i(n.replace(/[\|\-\\\/>»]+/g,""))-1)&&(t=n),t},_prepDocument:function(){var e=this._doc;this._removeNodes(this._getAllNodesWithTag(e,["style"])),e.body&&this._replaceBrs(e.body),this._replaceNodeTags(this._getAllNodesWithTag(e,["font"]),"SPAN")},_nextNode:function(e){for(var t=e;t&&t.nodeType!=this.ELEMENT_NODE&&this.REGEXPS.whitespace.test(t.textContent);)t=t.nextSibling;return t},_replaceBrs:function(e){this._forEachNode(this._getAllNodesWithTag(e,["br"]),(function(e){for(var t=e.nextSibling,n=!1;(t=this._nextNode(t))&&"BR"==t.tagName;){n=!0;var r=t.nextSibling;t.parentNode.removeChild(t),t=r}if(n){var i=this._doc.createElement("p");for(e.parentNode.replaceChild(i,e),t=i.nextSibling;t;){if("BR"==t.tagName){var a=this._nextNode(t.nextSibling);if(a&&"BR"==a.tagName)break}if(!this._isPhrasingContent(t))break;var o=t.nextSibling;i.appendChild(t),t=o}for(;i.lastChild&&this._isWhitespace(i.lastChild);)i.removeChild(i.lastChild);"P"===i.parentNode.tagName&&this._setNodeTag(i.parentNode,"DIV")}}))},_setNodeTag:function(e,t){if(this.log("_setNodeTag",e,t),this._docJSDOMParser)return e.localName=t.toLowerCase(),e.tagName=t.toUpperCase(),e;for(var n=e.ownerDocument.createElement(t);e.firstChild;)n.appendChild(e.firstChild);e.parentNode.replaceChild(n,e),e.readability&&(n.readability=e.readability);for(var r=0;r<e.attributes.length;r++)try{n.setAttribute(e.attributes[r].name,e.attributes[r].value)}catch(e){}return n},_prepArticle:function(e){this._cleanStyles(e),this._markDataTables(e),this._fixLazyImages(e),this._cleanConditionally(e,"form"),this._cleanConditionally(e,"fieldset"),this._clean(e,"object"),this._clean(e,"embed"),this._clean(e,"footer"),this._clean(e,"link"),this._clean(e,"aside");var t=this.DEFAULT_CHAR_THRESHOLD;this._forEachNode(e.children,(function(e){this._cleanMatchedNodes(e,(function(e,n){return this.REGEXPS.shareElements.test(n)&&e.textContent.length<t}))})),this._clean(e,"iframe"),this._clean(e,"input"),this._clean(e,"textarea"),this._clean(e,"select"),this._clean(e,"button"),this._cleanHeaders(e),this._cleanConditionally(e,"table"),this._cleanConditionally(e,"ul"),this._cleanConditionally(e,"div"),this._replaceNodeTags(this._getAllNodesWithTag(e,["h1"]),"h2"),this._removeNodes(this._getAllNodesWithTag(e,["p"]),(function(e){return 0===e.getElementsByTagName("img").length+e.getElementsByTagName("embed").length+e.getElementsByTagName("object").length+e.getElementsByTagName("iframe").length&&!this._getInnerText(e,!1)})),this._forEachNode(this._getAllNodesWithTag(e,["br"]),(function(e){var t=this._nextNode(e.nextSibling);t&&"P"==t.tagName&&e.parentNode.removeChild(e)})),this._forEachNode(this._getAllNodesWithTag(e,["table"]),(function(e){var t=this._hasSingleTagInsideElement(e,"TBODY")?e.firstElementChild:e;if(this._hasSingleTagInsideElement(t,"TR")){var n=t.firstElementChild;if(this._hasSingleTagInsideElement(n,"TD")){var r=n.firstElementChild;r=this._setNodeTag(r,this._everyNode(r.childNodes,this._isPhrasingContent)?"P":"DIV"),e.parentNode.replaceChild(r,e)}}}))},_initializeNode:function(e){switch(e.readability={contentScore:0},e.tagName){case"DIV":e.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":e.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":e.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":e.readability.contentScore-=5}e.readability.contentScore+=this._getClassWeight(e)},_removeAndGetNext:function(e){var t=this._getNextNode(e,!0);return e.parentNode.removeChild(e),t},_getNextNode:function(e,t){if(!t&&e.firstElementChild)return e.firstElementChild;if(e.nextElementSibling)return e.nextElementSibling;do{e=e.parentNode}while(e&&!e.nextElementSibling);return e&&e.nextElementSibling},_textSimilarity:function(e,t){var n=e.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean),r=t.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean);return n.length&&r.length?1-r.filter((e=>!n.includes(e))).join(" ").length/r.join(" ").length:0},_checkByline:function(e,t){if(this._articleByline)return!1;if(void 0!==e.getAttribute)var n=e.getAttribute("rel"),r=e.getAttribute("itemprop");return!(!("author"===n||r&&-1!==r.indexOf("author")||this.REGEXPS.byline.test(t))||!this._isValidByline(e.textContent)||(this._articleByline=e.textContent.trim(),0))},_getNodeAncestors:function(e,t){t=t||0;for(var n=0,r=[];e.parentNode&&(r.push(e.parentNode),!t||++n!==t);)e=e.parentNode;return r},_grabArticle:function(e){this.log("**** grabArticle ****");var t=this._doc,n=null!==e;if(!(e=e||this._doc.body))return this.log("No body found in document. Abort."),null;for(var r=e.innerHTML;;){this.log("Starting grabArticle loop");var i=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),a=[],o=this._doc.documentElement;let q=!0;for(;o;){"HTML"===o.tagName&&(this._articleLang=o.getAttribute("lang"));var s=o.className+" "+o.id;if(this._isProbablyVisible(o))if("true"!=o.getAttribute("aria-modal")||"dialog"!=o.getAttribute("role"))if(this._checkByline(o,s))o=this._removeAndGetNext(o);else if(q&&this._headerDuplicatesTitle(o))this.log("Removing header: ",o.textContent.trim(),this._articleTitle.trim()),q=!1,o=this._removeAndGetNext(o);else{if(i){if(this.REGEXPS.unlikelyCandidates.test(s)&&!this.REGEXPS.okMaybeItsACandidate.test(s)&&!this._hasAncestorTag(o,"table")&&!this._hasAncestorTag(o,"code")&&"BODY"!==o.tagName&&"A"!==o.tagName){this.log("Removing unlikely candidate - "+s),o=this._removeAndGetNext(o);continue}if(this.UNLIKELY_ROLES.includes(o.getAttribute("role"))){this.log("Removing content with role "+o.getAttribute("role")+" - "+s),o=this._removeAndGetNext(o);continue}}if("DIV"!==o.tagName&&"SECTION"!==o.tagName&&"HEADER"!==o.tagName&&"H1"!==o.tagName&&"H2"!==o.tagName&&"H3"!==o.tagName&&"H4"!==o.tagName&&"H5"!==o.tagName&&"H6"!==o.tagName||!this._isElementWithoutContent(o)){if(-1!==this.DEFAULT_TAGS_TO_SCORE.indexOf(o.tagName)&&a.push(o),"DIV"===o.tagName){for(var l=null,c=o.firstChild;c;){var d=c.nextSibling;if(this._isPhrasingContent(c))null!==l?l.appendChild(c):this._isWhitespace(c)||(l=t.createElement("p"),o.replaceChild(l,c),l.appendChild(c));else if(null!==l){for(;l.lastChild&&this._isWhitespace(l.lastChild);)l.removeChild(l.lastChild);l=null}c=d}if(this._hasSingleTagInsideElement(o,"P")&&this._getLinkDensity(o)<.25){var u=o.children[0];o.parentNode.replaceChild(u,o),o=u,a.push(o)}else this._hasChildBlockElement(o)||(o=this._setNodeTag(o,"P"),a.push(o))}o=this._getNextNode(o)}else o=this._removeAndGetNext(o)}else o=this._removeAndGetNext(o);else this.log("Removing hidden node - "+s),o=this._removeAndGetNext(o)}var h=[];this._forEachNode(a,(function(e){if(e.parentNode&&void 0!==e.parentNode.tagName){var t=this._getInnerText(e);if(!(t.length<25)){var n=this._getNodeAncestors(e,5);if(0!==n.length){var r=0;r+=1,r+=t.split(this.REGEXPS.commas).length,r+=Math.min(Math.floor(t.length/100),3),this._forEachNode(n,(function(e,t){if(e.tagName&&e.parentNode&&void 0!==e.parentNode.tagName){if(void 0===e.readability&&(this._initializeNode(e),h.push(e)),0===t)var n=1;else n=1===t?2:3*t;e.readability.contentScore+=r/n}}))}}}}));for(var p=[],m=0,f=h.length;m<f;m+=1){var g=h[m],v=g.readability.contentScore*(1-this._getLinkDensity(g));g.readability.contentScore=v,this.log("Candidate:",g,"with score "+v);for(var y=0;y<this._nbTopCandidates;y++){var b=p[y];if(!b||v>b.readability.contentScore){p.splice(y,0,g),p.length>this._nbTopCandidates&&p.pop();break}}}var E,_=p[0]||null,N=!1;if(null===_||"BODY"===_.tagName){for(_=t.createElement("DIV"),N=!0;e.firstChild;)this.log("Moving child out:",e.firstChild),_.appendChild(e.firstChild);e.appendChild(_),this._initializeNode(_)}else if(_){for(var A=[],T=1;T<p.length;T++)p[T].readability.contentScore/_.readability.contentScore>=.75&&A.push(this._getNodeAncestors(p[T]));if(A.length>=3)for(E=_.parentNode;"BODY"!==E.tagName;){for(var S=0,w=0;w<A.length&&S<3;w++)S+=Number(A[w].includes(E));if(S>=3){_=E;break}E=E.parentNode}_.readability||this._initializeNode(_),E=_.parentNode;for(var C=_.readability.contentScore,L=C/3;"BODY"!==E.tagName;)if(E.readability){var x=E.readability.contentScore;if(x<L)break;if(x>C){_=E;break}C=E.readability.contentScore,E=E.parentNode}else E=E.parentNode;for(E=_.parentNode;"BODY"!=E.tagName&&1==E.children.length;)E=(_=E).parentNode;_.readability||this._initializeNode(_)}var I=t.createElement("DIV");n&&(I.id="readability-content");for(var D=Math.max(10,.2*_.readability.contentScore),O=(E=_.parentNode).children,M=0,k=O.length;M<k;M++){var B=O[M],$=!1;if(this.log("Looking at sibling node:",B,B.readability?"with score "+B.readability.contentScore:""),this.log("Sibling has score",B.readability?B.readability.contentScore:"Unknown"),B===_)$=!0;else{var R=0;if(B.className===_.className&&""!==_.className&&(R+=.2*_.readability.contentScore),B.readability&&B.readability.contentScore+R>=D)$=!0;else if("P"===B.nodeName){var P=this._getLinkDensity(B),H=this._getInnerText(B),F=H.length;(F>80&&P<.25||F<80&&F>0&&0===P&&-1!==H.search(/\.( |$)/))&&($=!0)}}$&&(this.log("Appending node:",B),-1===this.ALTER_TO_DIV_EXCEPTIONS.indexOf(B.nodeName)&&(this.log("Altering sibling:",B,"to div."),B=this._setNodeTag(B,"DIV")),I.appendChild(B),O=E.children,M-=1,k-=1)}if(this._debug&&this.log("Article content pre-prep: "+I.innerHTML),this._prepArticle(I),this._debug&&this.log("Article content post-prep: "+I.innerHTML),N)_.id="readability-page-1",_.className="page";else{var U=t.createElement("DIV");for(U.id="readability-page-1",U.className="page";I.firstChild;)U.appendChild(I.firstChild);I.appendChild(U)}this._debug&&this.log("Article content after paging: "+I.innerHTML);var j=!0,G=this._getInnerText(I,!0).length;if(G<this._charThreshold)if(j=!1,e.innerHTML=r,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS),this._attempts.push({articleContent:I,textLength:G});else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES),this._attempts.push({articleContent:I,textLength:G});else if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY),this._attempts.push({articleContent:I,textLength:G});else{if(this._attempts.push({articleContent:I,textLength:G}),this._attempts.sort((function(e,t){return t.textLength-e.textLength})),!this._attempts[0].textLength)return null;I=this._attempts[0].articleContent,j=!0}if(j){var W=[E,_].concat(this._getNodeAncestors(E));return this._someNode(W,(function(e){if(!e.tagName)return!1;var t=e.getAttribute("dir");return!!t&&(this._articleDir=t,!0)})),I}}},_isValidByline:function(e){return("string"==typeof e||e instanceof String)&&(e=e.trim()).length>0&&e.length<100},_unescapeHtmlEntities:function(e){if(!e)return e;var t=this.HTML_ESCAPE_MAP;return e.replace(/&(quot|amp|apos|lt|gt);/g,(function(e,n){return t[n]})).replace(/&#(?:x([0-9a-z]{1,4})|([0-9]{1,4}));/gi,(function(e,t,n){var r=parseInt(t||n,t?16:10);return String.fromCharCode(r)}))},_getJSONLD:function(e){var t,n=this._getAllNodesWithTag(e,["script"]);return this._forEachNode(n,(function(e){if(!t&&"application/ld+json"===e.getAttribute("type"))try{var n=e.textContent.replace(/^\s*<!\[CDATA\[|\]\]>\s*$/g,""),r=JSON.parse(n);if(!r["@context"]||!r["@context"].match(/^https?\:\/\/schema\.org$/))return;if(!r["@type"]&&Array.isArray(r["@graph"])&&(r=r["@graph"].find((function(e){return(e["@type"]||"").match(this.REGEXPS.jsonLdArticleTypes)}))),!r||!r["@type"]||!r["@type"].match(this.REGEXPS.jsonLdArticleTypes))return;if(t={},"string"==typeof r.name&&"string"==typeof r.headline&&r.name!==r.headline){var i=this._getArticleTitle(),a=this._textSimilarity(r.name,i)>.75,o=this._textSimilarity(r.headline,i)>.75;t.title=o&&!a?r.headline:r.name}else"string"==typeof r.name?t.title=r.name.trim():"string"==typeof r.headline&&(t.title=r.headline.trim());return r.author&&("string"==typeof r.author.name?t.byline=r.author.name.trim():Array.isArray(r.author)&&r.author[0]&&"string"==typeof r.author[0].name&&(t.byline=r.author.filter((function(e){return e&&"string"==typeof e.name})).map((function(e){return e.name.trim()})).join(", "))),"string"==typeof r.description&&(t.excerpt=r.description.trim()),r.publisher&&"string"==typeof r.publisher.name&&(t.siteName=r.publisher.name.trim()),void("string"==typeof r.datePublished&&(t.datePublished=r.datePublished.trim()))}catch(e){this.log(e.message)}})),t||{}},_getArticleMetadata:function(e){var t={},n={},r=this._doc.getElementsByTagName("meta"),i=/\s*(article|dc|dcterm|og|twitter)\s*:\s*(author|creator|description|published_time|title|site_name)\s*/gi,a=/^\s*(?:(dc|dcterm|og|twitter|weibo:(article|webpage))\s*[\.:]\s*)?(author|creator|description|title|site_name)\s*$/i;return this._forEachNode(r,(function(e){var t=e.getAttribute("name"),r=e.getAttribute("property"),o=e.getAttribute("content");if(o){var s=null,l=null;r&&(s=r.match(i))&&(l=s[0].toLowerCase().replace(/\s/g,""),n[l]=o.trim()),!s&&t&&a.test(t)&&(l=t,o&&(l=l.toLowerCase().replace(/\s/g,"").replace(/\./g,":"),n[l]=o.trim()))}})),t.title=e.title||n["dc:title"]||n["dcterm:title"]||n["og:title"]||n["weibo:article:title"]||n["weibo:webpage:title"]||n.title||n["twitter:title"],t.title||(t.title=this._getArticleTitle()),t.byline=e.byline||n["dc:creator"]||n["dcterm:creator"]||n.author,t.excerpt=e.excerpt||n["dc:description"]||n["dcterm:description"]||n["og:description"]||n["weibo:article:description"]||n["weibo:webpage:description"]||n.description||n["twitter:description"],t.siteName=e.siteName||n["og:site_name"],t.publishedTime=e.datePublished||n["article:published_time"]||null,t.title=this._unescapeHtmlEntities(t.title),t.byline=this._unescapeHtmlEntities(t.byline),t.excerpt=this._unescapeHtmlEntities(t.excerpt),t.siteName=this._unescapeHtmlEntities(t.siteName),t.publishedTime=this._unescapeHtmlEntities(t.publishedTime),t},_isSingleImage:function(e){return"IMG"===e.tagName||1===e.children.length&&""===e.textContent.trim()&&this._isSingleImage(e.children[0])},_unwrapNoscriptImages:function(e){var t=Array.from(e.getElementsByTagName("img"));this._forEachNode(t,(function(e){for(var t=0;t<e.attributes.length;t++){var n=e.attributes[t];switch(n.name){case"src":case"srcset":case"data-src":case"data-srcset":return}if(/\.(jpg|jpeg|png|webp)/i.test(n.value))return}e.parentNode.removeChild(e)}));var n=Array.from(e.getElementsByTagName("noscript"));this._forEachNode(n,(function(t){var n=e.createElement("div");if(n.innerHTML=t.innerHTML,this._isSingleImage(n)){var r=t.previousElementSibling;if(r&&this._isSingleImage(r)){var i=r;"IMG"!==i.tagName&&(i=r.getElementsByTagName("img")[0]);for(var a=n.getElementsByTagName("img")[0],o=0;o<i.attributes.length;o++){var s=i.attributes[o];if(""!==s.value&&("src"===s.name||"srcset"===s.name||/\.(jpg|jpeg|png|webp)/i.test(s.value))){if(a.getAttribute(s.name)===s.value)continue;var l=s.name;a.hasAttribute(l)&&(l="data-old-"+l),a.setAttribute(l,s.value)}}t.parentNode.replaceChild(n.firstElementChild,r)}}}))},_removeScripts:function(e){this._removeNodes(this._getAllNodesWithTag(e,["script","noscript"]))},_hasSingleTagInsideElement:function(e,t){return 1==e.children.length&&e.children[0].tagName===t&&!this._someNode(e.childNodes,(function(e){return e.nodeType===this.TEXT_NODE&&this.REGEXPS.hasContent.test(e.textContent)}))},_isElementWithoutContent:function(e){return e.nodeType===this.ELEMENT_NODE&&0==e.textContent.trim().length&&(0==e.children.length||e.children.length==e.getElementsByTagName("br").length+e.getElementsByTagName("hr").length)},_hasChildBlockElement:function(e){return this._someNode(e.childNodes,(function(e){return this.DIV_TO_P_ELEMS.has(e.tagName)||this._hasChildBlockElement(e)}))},_isPhrasingContent:function(e){return e.nodeType===this.TEXT_NODE||-1!==this.PHRASING_ELEMS.indexOf(e.tagName)||("A"===e.tagName||"DEL"===e.tagName||"INS"===e.tagName)&&this._everyNode(e.childNodes,this._isPhrasingContent)},_isWhitespace:function(e){return e.nodeType===this.TEXT_NODE&&0===e.textContent.trim().length||e.nodeType===this.ELEMENT_NODE&&"BR"===e.tagName},_getInnerText:function(e,t){t=void 0===t||t;var n=e.textContent.trim();return t?n.replace(this.REGEXPS.normalize," "):n},_getCharCount:function(e,t){return t=t||",",this._getInnerText(e).split(t).length-1},_cleanStyles:function(e){if(e&&"svg"!==e.tagName.toLowerCase()){for(var t=0;t<this.PRESENTATIONAL_ATTRIBUTES.length;t++)e.removeAttribute(this.PRESENTATIONAL_ATTRIBUTES[t]);-1!==this.DEPRECATED_SIZE_ATTRIBUTE_ELEMS.indexOf(e.tagName)&&(e.removeAttribute("width"),e.removeAttribute("height"));for(var n=e.firstElementChild;null!==n;)this._cleanStyles(n),n=n.nextElementSibling}},_getLinkDensity:function(e){var t=this._getInnerText(e).length;if(0===t)return 0;var n=0;return this._forEachNode(e.getElementsByTagName("a"),(function(e){var t=e.getAttribute("href"),r=t&&this.REGEXPS.hashUrl.test(t)?.3:1;n+=this._getInnerText(e).length*r})),n/t},_getClassWeight:function(e){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var t=0;return"string"==typeof e.className&&""!==e.className&&(this.REGEXPS.negative.test(e.className)&&(t-=25),this.REGEXPS.positive.test(e.className)&&(t+=25)),"string"==typeof e.id&&""!==e.id&&(this.REGEXPS.negative.test(e.id)&&(t-=25),this.REGEXPS.positive.test(e.id)&&(t+=25)),t},_clean:function(e,t){var n=-1!==["object","embed","iframe"].indexOf(t);this._removeNodes(this._getAllNodesWithTag(e,[t]),(function(e){if(n){for(var t=0;t<e.attributes.length;t++)if(this._allowedVideoRegex.test(e.attributes[t].value))return!1;if("object"===e.tagName&&this._allowedVideoRegex.test(e.innerHTML))return!1}return!0}))},_hasAncestorTag:function(e,t,n,r){n=n||3,t=t.toUpperCase();for(var i=0;e.parentNode;){if(n>0&&i>n)return!1;if(e.parentNode.tagName===t&&(!r||r(e.parentNode)))return!0;e=e.parentNode,i++}return!1},_getRowAndColumnCount:function(e){for(var t=0,n=0,r=e.getElementsByTagName("tr"),i=0;i<r.length;i++){var a=r[i].getAttribute("rowspan")||0;a&&(a=parseInt(a,10)),t+=a||1;for(var o=0,s=r[i].getElementsByTagName("td"),l=0;l<s.length;l++){var c=s[l].getAttribute("colspan")||0;c&&(c=parseInt(c,10)),o+=c||1}n=Math.max(n,o)}return{rows:t,columns:n}},_markDataTables:function(e){for(var t=e.getElementsByTagName("table"),n=0;n<t.length;n++){var r=t[n];if("presentation"!=r.getAttribute("role"))if("0"!=r.getAttribute("datatable"))if(r.getAttribute("summary"))r._readabilityDataTable=!0;else{var i=r.getElementsByTagName("caption")[0];if(i&&i.childNodes.length>0)r._readabilityDataTable=!0;else if(["col","colgroup","tfoot","thead","th"].some((function(e){return!!r.getElementsByTagName(e)[0]})))this.log("Data table because found data-y descendant"),r._readabilityDataTable=!0;else if(r.getElementsByTagName("table")[0])r._readabilityDataTable=!1;else{var a=this._getRowAndColumnCount(r);a.rows>=10||a.columns>4?r._readabilityDataTable=!0:r._readabilityDataTable=a.rows*a.columns>10}}else r._readabilityDataTable=!1;else r._readabilityDataTable=!1}},_fixLazyImages:function(e){this._forEachNode(this._getAllNodesWithTag(e,["img","picture","figure"]),(function(e){if(e.src&&this.REGEXPS.b64DataUrl.test(e.src)){if("image/svg+xml"===this.REGEXPS.b64DataUrl.exec(e.src)[1])return;for(var t=!1,n=0;n<e.attributes.length;n++){var r=e.attributes[n];if("src"!==r.name&&/\.(jpg|jpeg|png|webp)/i.test(r.value)){t=!0;break}}if(t){var i=e.src.search(/base64\s*/i)+7;e.src.length-i<133&&e.removeAttribute("src")}}if(!(e.src||e.srcset&&"null"!=e.srcset)||-1!==e.className.toLowerCase().indexOf("lazy"))for(var a=0;a<e.attributes.length;a++)if("src"!==(r=e.attributes[a]).name&&"srcset"!==r.name&&"alt"!==r.name){var o=null;if(/\.(jpg|jpeg|png|webp)\s+\d/.test(r.value)?o="srcset":/^\s*\S+\.(jpg|jpeg|png|webp)\S*\s*$/.test(r.value)&&(o="src"),o)if("IMG"===e.tagName||"PICTURE"===e.tagName)e.setAttribute(o,r.value);else if("FIGURE"===e.tagName&&!this._getAllNodesWithTag(e,["img","picture"]).length){var s=this._doc.createElement("img");s.setAttribute(o,r.value),e.appendChild(s)}}}))},_getTextDensity:function(e,t){var n=this._getInnerText(e,!0).length;if(0===n)return 0;var r=0,i=this._getAllNodesWithTag(e,t);return this._forEachNode(i,(e=>r+=this._getInnerText(e,!0).length)),r/n},_cleanConditionally:function(e,t){this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)&&this._removeNodes(this._getAllNodesWithTag(e,[t]),(function(e){var n=function(e){return e._readabilityDataTable},r="ul"===t||"ol"===t;if(!r){var i=0,a=this._getAllNodesWithTag(e,["ul","ol"]);this._forEachNode(a,(e=>i+=this._getInnerText(e).length)),r=i/this._getInnerText(e).length>.9}if("table"===t&&n(e))return!1;if(this._hasAncestorTag(e,"table",-1,n))return!1;if(this._hasAncestorTag(e,"code"))return!1;var o=this._getClassWeight(e);if(this.log("Cleaning Conditionally",e),o+0<0)return!0;if(this._getCharCount(e,",")<10){for(var s=e.getElementsByTagName("p").length,l=e.getElementsByTagName("img").length,c=e.getElementsByTagName("li").length-100,d=e.getElementsByTagName("input").length,u=this._getTextDensity(e,["h1","h2","h3","h4","h5","h6"]),h=0,p=this._getAllNodesWithTag(e,["object","embed","iframe"]),m=0;m<p.length;m++){for(var f=0;f<p[m].attributes.length;f++)if(this._allowedVideoRegex.test(p[m].attributes[f].value))return!1;if("object"===p[m].tagName&&this._allowedVideoRegex.test(p[m].innerHTML))return!1;h++}var g=this._getLinkDensity(e),v=this._getInnerText(e).length,y=l>1&&s/l<.5&&!this._hasAncestorTag(e,"figure")||!r&&c>s||d>Math.floor(s/3)||!r&&u<.9&&v<25&&(0===l||l>2)&&!this._hasAncestorTag(e,"figure")||!r&&o<25&&g>.2||o>=25&&g>.5||1===h&&v<75||h>1;if(r&&y){for(var b=0;b<e.children.length;b++)if(e.children[b].children.length>1)return y;if(l==e.getElementsByTagName("li").length)return!1}return y}return!1}))},_cleanMatchedNodes:function(e,t){for(var n=this._getNextNode(e,!0),r=this._getNextNode(e);r&&r!=n;)r=t.call(this,r,r.className+" "+r.id)?this._removeAndGetNext(r):this._getNextNode(r)},_cleanHeaders:function(e){let t=this._getAllNodesWithTag(e,["h1","h2"]);this._removeNodes(t,(function(e){let t=this._getClassWeight(e)<0;return t&&this.log("Removing header with low class weight:",e),t}))},_headerDuplicatesTitle:function(e){if("H1"!=e.tagName&&"H2"!=e.tagName)return!1;var t=this._getInnerText(e,!1);return this.log("Evaluating similarity of header:",t,this._articleTitle),this._textSimilarity(this._articleTitle,t)>.75},_flagIsActive:function(e){return(this._flags&e)>0},_removeFlag:function(e){this._flags=this._flags&~e},_isProbablyVisible:function(e){return(!e.style||"none"!=e.style.display)&&(!e.style||"hidden"!=e.style.visibility)&&!e.hasAttribute("hidden")&&(!e.hasAttribute("aria-hidden")||"true"!=e.getAttribute("aria-hidden")||e.className&&e.className.indexOf&&-1!==e.className.indexOf("fallback-image"))},parse:function(){if(this._maxElemsToParse>0){var e=this._doc.getElementsByTagName("*").length;if(e>this._maxElemsToParse)throw new Error("Aborting parsing document; "+e+" elements found")}this._unwrapNoscriptImages(this._doc);var t=this._disableJSONLD?{}:this._getJSONLD(this._doc);this._removeScripts(this._doc),this._prepDocument();var n=this._getArticleMetadata(t);this._articleTitle=n.title;var r=this._grabArticle();if(!r)return null;if(this.log("Grabbed: "+r.innerHTML),this._postProcessContent(r),!n.excerpt){var i=r.getElementsByTagName("p");i.length>0&&(n.excerpt=i[0].textContent.trim())}var a=r.textContent;return{title:this._articleTitle,byline:n.byline||this._articleByline,dir:this._articleDir,lang:this._articleLang,content:this._serializer(r),textContent:a,length:a.length,excerpt:n.excerpt,siteName:n.siteName||this._articleSiteName,publishedTime:n.publishedTime}}},e.exports=t},396:(e,t,n)=>{var r=n(238),i=n(804);e.exports={Readability:r,isProbablyReaderable:i}},353:function(e){e.exports=function(){var e=6e4,t=36e5,n="millisecond",r="second",i="minute",a="hour",o="day",s="week",l="month",c="quarter",d="year",u="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},g=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},v={s:g,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+g(r,2,"0")+":"+g(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,l),a=n-i<0,o=t.clone().add(r+(a?-1:1),l);return+(-(r+(n-i)/(a?i-o:o-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:d,w:s,d:o,D:u,h:a,m:i,s:r,ms:n,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=f;var E="$isDayjsObject",_=function(e){return e instanceof S||!(!e||!e[E])},N=function e(t,n,r){var i;if(!t)return y;if("string"==typeof t){var a=t.toLowerCase();b[a]&&(i=a),n&&(b[a]=n,i=a);var o=t.split("-");if(!i&&o.length>1)return e(o[0])}else{var s=t.name;b[s]=t,i=s}return!r&&i&&(y=i),i||!r&&y},A=function(e,t){if(_(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new S(n)},T=v;T.l=N,T.i=_,T.w=function(e,t){return A(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function f(e){this.$L=N(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[E]=!0}var g=f.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(T.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(p);if(r){var i=r[2]-1||0,a=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return T},g.isValid=function(){return!(this.$d.toString()===h)},g.isSame=function(e,t){var n=A(e);return this.startOf(t)<=n&&n<=this.endOf(t)},g.isAfter=function(e,t){return A(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<A(e)},g.$g=function(e,t,n){return T.u(e)?this[t]:this.set(n,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var n=this,c=!!T.u(t)||t,h=T.p(e),p=function(e,t){var r=T.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return c?r:r.endOf(o)},m=function(e,t){return T.w(n.toDate()[e].apply(n.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},f=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case d:return c?p(1,0):p(31,11);case l:return c?p(1,g):p(0,g+1);case s:var b=this.$locale().weekStart||0,E=(f<b?f+7:f)-b;return p(c?v-E:v+(6-E),g);case o:case u:return m(y+"Hours",0);case a:return m(y+"Minutes",1);case i:return m(y+"Seconds",2);case r:return m(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var s,c=T.p(e),h="set"+(this.$u?"UTC":""),p=(s={},s[o]=h+"Date",s[u]=h+"Date",s[l]=h+"Month",s[d]=h+"FullYear",s[a]=h+"Hours",s[i]=h+"Minutes",s[r]=h+"Seconds",s[n]=h+"Milliseconds",s)[c],m=c===o?this.$D+(t-this.$W):t;if(c===l||c===d){var f=this.clone().set(u,1);f.$d[p](m),f.init(),this.$d=f.set(u,Math.min(this.$D,f.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[T.p(e)]()},g.add=function(n,c){var u,h=this;n=Number(n);var p=T.p(c),m=function(e){var t=A(h);return T.w(t.date(t.date()+Math.round(e*n)),h)};if(p===l)return this.set(l,this.$M+n);if(p===d)return this.set(d,this.$y+n);if(p===o)return m(1);if(p===s)return m(7);var f=(u={},u[i]=e,u[a]=t,u[r]=1e3,u)[p]||1,g=this.$d.getTime()+n*f;return T.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=T.z(this),a=this.$H,o=this.$m,s=this.$M,l=n.weekdays,c=n.months,d=n.meridiem,u=function(e,n,i,a){return e&&(e[n]||e(t,r))||i[n].slice(0,a)},p=function(e){return T.s(a%12||12,e,"0")},f=d||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(m,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return T.s(t.$y,4,"0");case"M":return s+1;case"MM":return T.s(s+1,2,"0");case"MMM":return u(n.monthsShort,s,c,3);case"MMMM":return u(c,s);case"D":return t.$D;case"DD":return T.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(n.weekdaysMin,t.$W,l,2);case"ddd":return u(n.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(a);case"HH":return T.s(a,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return f(a,o,!0);case"A":return f(a,o,!1);case"m":return String(o);case"mm":return T.s(o,2,"0");case"s":return String(t.$s);case"ss":return T.s(t.$s,2,"0");case"SSS":return T.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,u,h){var p,m=this,f=T.p(u),g=A(n),v=(g.utcOffset()-this.utcOffset())*e,y=this-g,b=function(){return T.m(m,g)};switch(f){case d:p=b()/12;break;case l:p=b();break;case c:p=b()/3;break;case s:p=(y-v)/6048e5;break;case o:p=(y-v)/864e5;break;case a:p=y/t;break;case i:p=y/e;break;case r:p=y/1e3;break;default:p=y}return h?p:T.a(p)},g.daysInMonth=function(){return this.endOf(l).$D},g.$locale=function(){return b[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=N(e,t,!0);return r&&(n.$L=r),n},g.clone=function(){return T.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},f}(),w=S.prototype;return A.prototype=w,[["$ms",n],["$s",r],["$m",i],["$H",a],["$W",o],["$M",l],["$y",d],["$D",u]].forEach((function(e){w[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),A.extend=function(e,t){return e.$i||(e(t,S,A),e.$i=!0),A},A.locale=N,A.isDayjs=_,A.unix=function(e){return A(1e3*e)},A.en=b[y],A.Ls=b,A.p={},A}()},835:(e,t,n)=>{n.d(t,{Tzs:()=>o});const r=(e,t,n=[])=>{const i=document.createElementNS("http://www.w3.org/2000/svg",e);return Object.keys(t).forEach((e=>{i.setAttribute(e,String(t[e]))})),n.length&&n.forEach((e=>{const t=r(...e);i.appendChild(t)})),i},i=e=>"string"==typeof e?e:e&&e.class?e.class&&"string"==typeof e.class?e.class.split(" "):e.class&&Array.isArray(e.class)?e.class:"":"",a=(e,{nameAttr:t,icons:n,attrs:a})=>{const o=e.getAttribute(t);if(null==o)return;const s=n[o.replace(/(\w)(\w*)(_|-|\s*)/g,((e,t,n)=>t.toUpperCase()+n.toLowerCase()))];if(!s)return console.warn(`${e.outerHTML} icon name was not found in the provided icons object.`);const l=(e=>Array.from(e.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{}))(e),[c,d,u]=s,h={...d,"data-lucide":o,...a,...l},p=["lucide",`lucide-${o}`,l,a].flatMap(i).map((e=>e.trim())).filter(Boolean).filter(((e,t,n)=>n.indexOf(e)===t)).join(" ");p&&Object.assign(h,{class:p});const m=(([e,t,n])=>r(e,t,n))([c,h,u]);return e.parentNode?.replaceChild(m,e)},o=({icons:e={},nameAttr:t="data-lucide",attrs:n={}}={})=>{if(!Object.values(e).length)throw new Error("Please provide an icons object.\nIf you want to use all the icons you can import it like:\n `import { createIcons, icons } from 'lucide';\nlucide.createIcons({icons});`");if("undefined"==typeof document)throw new Error("`createIcons()` only works in a browser environment.");const r=document.querySelectorAll(`[${t}]`);if(Array.from(r).forEach((r=>a(r,{nameAttr:t,icons:e,attrs:n}))),"data-lucide"===t){const t=document.querySelectorAll("[icon-name]");t.length>0&&(console.warn("[Lucide] Some icons were found with the now deprecated icon-name attribute. These will still be replaced for backwards compatibility, but will no longer be supported in v1.0 and you should switch to data-lucide"),Array.from(t).forEach((t=>a(t,{nameAttr:"icon-name",icons:e,attrs:n}))))}}},992:(e,t,n)=>{var r,i=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function i(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var a={compressToBase64:function(e){if(null==e)return"";var n=a._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:a._decompress(e.length,32,(function(n){return i(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":a._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=a.compress(e),n=new Uint8Array(2*t.length),r=0,i=t.length;r<i;r++){var o=t.charCodeAt(r);n[2*r]=o>>>8,n[2*r+1]=o%256}return n},decompressFromUint8Array:function(t){if(null==t)return a.decompress(t);for(var n=new Array(t.length/2),r=0,i=n.length;r<i;r++)n[r]=256*t[2*r]+t[2*r+1];var o=[];return n.forEach((function(t){o.push(e(t))})),a.decompress(o.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),a._decompress(e.length,32,(function(t){return i(n,e.charAt(t))})))},compress:function(t){return a._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var r,i,a,o={},s={},l="",c="",d="",u=2,h=3,p=2,m=[],f=0,g=0;for(a=0;a<e.length;a+=1)if(l=e.charAt(a),Object.prototype.hasOwnProperty.call(o,l)||(o[l]=h++,s[l]=!0),c=d+l,Object.prototype.hasOwnProperty.call(o,c))d=c;else{if(Object.prototype.hasOwnProperty.call(s,d)){if(d.charCodeAt(0)<256){for(r=0;r<p;r++)f<<=1,g==t-1?(g=0,m.push(n(f)),f=0):g++;for(i=d.charCodeAt(0),r=0;r<8;r++)f=f<<1|1&i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i>>=1}else{for(i=1,r=0;r<p;r++)f=f<<1|i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i=0;for(i=d.charCodeAt(0),r=0;r<16;r++)f=f<<1|1&i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i>>=1}0==--u&&(u=Math.pow(2,p),p++),delete s[d]}else for(i=o[d],r=0;r<p;r++)f=f<<1|1&i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i>>=1;0==--u&&(u=Math.pow(2,p),p++),o[c]=h++,d=String(l)}if(""!==d){if(Object.prototype.hasOwnProperty.call(s,d)){if(d.charCodeAt(0)<256){for(r=0;r<p;r++)f<<=1,g==t-1?(g=0,m.push(n(f)),f=0):g++;for(i=d.charCodeAt(0),r=0;r<8;r++)f=f<<1|1&i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i>>=1}else{for(i=1,r=0;r<p;r++)f=f<<1|i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i=0;for(i=d.charCodeAt(0),r=0;r<16;r++)f=f<<1|1&i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i>>=1}0==--u&&(u=Math.pow(2,p),p++),delete s[d]}else for(i=o[d],r=0;r<p;r++)f=f<<1|1&i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i>>=1;0==--u&&(u=Math.pow(2,p),p++)}for(i=2,r=0;r<p;r++)f=f<<1|1&i,g==t-1?(g=0,m.push(n(f)),f=0):g++,i>>=1;for(;;){if(f<<=1,g==t-1){m.push(n(f));break}g++}return m.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,r){var i,a,o,s,l,c,d,u=[],h=4,p=4,m=3,f="",g=[],v={val:r(0),position:n,index:1};for(i=0;i<3;i+=1)u[i]=i;for(o=0,l=Math.pow(2,2),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*c,c<<=1;switch(o){case 0:for(o=0,l=Math.pow(2,8),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*c,c<<=1;d=e(o);break;case 1:for(o=0,l=Math.pow(2,16),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*c,c<<=1;d=e(o);break;case 2:return""}for(u[3]=d,a=d,g.push(d);;){if(v.index>t)return"";for(o=0,l=Math.pow(2,m),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*c,c<<=1;switch(d=o){case 0:for(o=0,l=Math.pow(2,8),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*c,c<<=1;u[p++]=e(o),d=p-1,h--;break;case 1:for(o=0,l=Math.pow(2,16),c=1;c!=l;)s=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),o|=(s>0?1:0)*c,c<<=1;u[p++]=e(o),d=p-1,h--;break;case 2:return g.join("")}if(0==h&&(h=Math.pow(2,m),m++),u[d])f=u[d];else{if(d!==p)return null;f=a+a.charAt(0)}g.push(f),u[p++]=a+f.charAt(0),a=f,0==--h&&(h=Math.pow(2,m),m++)}}};return a}();void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)},783:(e,t,n)=>{n.d(t,{b:()=>p});var r=n(436),i=n(213),a=n(102);function o(){const e=document.getElementById("template-settings-form");if(!e)return void console.error("Template form not found");const t=(e=>{let t=null;return function(...n){const r=this;t&&clearTimeout(t),t=setTimeout((()=>e.apply(r,n)),1e3)}})((()=>{return e=this,t=void 0,i=function*(){try{const e=yield(0,r.tR)();e.length>0&&((0,r.wK)(),console.log("Auto-save completed"),function(e){console.warn(e.join("\n"))}(e))}catch(e){console.error("Auto-save failed:",e)}},new((n=void 0)||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}));var e,t,n,i}));e.addEventListener("input",(()=>{-1!==r.H0&&((0,r.G_)(),t())}));const n=document.getElementById("template-properties");n&&(n.addEventListener("click",(e=>{const n=e.target;(n.classList.contains("remove-property-btn")||n.closest(".remove-property-btn"))&&-1!==r.H0&&((0,r.G_)(),t())})),n.addEventListener("change",(e=>{e.target.classList.contains("property-type")&&-1!==r.H0&&((0,r.G_)(),t())})));const i=document.getElementById("add-property-btn");i?i.addEventListener("click",(()=>{(0,r.JE)(),-1!==r.H0&&((0,r.G_)(),t())})):console.error("Add property button not found")}function s(){if(-1===r.H0)return void alert("Please select a template to export.");const e=r.kT[r.H0],t=`${n=e.name,n.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase()}-clipper.json`;var n;const i={schemaVersion:"0.1.0",name:e.name,behavior:e.behavior,noteNameFormat:e.noteNameFormat,path:e.path,noteContentFormat:e.noteContentFormat,properties:e.properties.map((({name:e,value:t,type:n})=>({name:e,value:t,type:n}))),triggers:e.triggers},a=JSON.stringify(i,null,2),o=new Blob([a],{type:"application/json"}),s=URL.createObjectURL(o),l=document.createElement("a");l.href=s,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}function l(){const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!n)return;const i=new FileReader;i.onload=e=>{var t,n;try{const i=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);if(!c(i))throw new Error("Invalid template file");i.id=Date.now().toString()+Math.random().toString(36).substr(2,9),i.properties=null===(n=i.properties)||void 0===n?void 0:n.map((e=>Object.assign(Object.assign({},e),{id:Date.now().toString()+Math.random().toString(36).substr(2,9)})));let a=i.name,o=1;for(;r.kT.some((e=>e.name===a));)a=`${i.name} (${o++})`;i.name=a,r.kT.push(i),(0,r.tR)(),(0,r.wK)(),(0,r.XM)(i)}catch(e){console.error("Error parsing imported template:",e),alert("Error importing template. Please check the file and try again.")}},i.readAsText(n)},e.click()}function c(e){const t=["text","multitext","number","checkbox","date","datetime"];return["name","behavior","path","properties","noteContentFormat"].every((t=>e.hasOwnProperty(t)))&&Array.isArray(e.properties)&&e.properties.every((e=>e.hasOwnProperty("name")&&e.hasOwnProperty("value")&&e.hasOwnProperty("type")&&t.includes(e.type)))}function d(e){const t=new FileReader;t.onload=e=>{var t,n;try{const i=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);if(!c(i))throw new Error("Invalid template file");i.id=Date.now().toString()+Math.random().toString(36).substr(2,9),i.properties=null===(n=i.properties)||void 0===n?void 0:n.map((e=>Object.assign(Object.assign({},e),{id:Date.now().toString()+Math.random().toString(36).substr(2,9)})));let a=i.name,o=1;for(;r.kT.some((e=>e.name===a));)a=`${i.name} (${o++})`;i.name=a,r.kT.push(i),(0,r.tR)(),(0,r.wK)(),(0,r.XM)(i)}catch(e){console.error("Error parsing imported template:",e),alert("Error importing template. Please check the file and try again.")}},t.readAsText(e)}var u=n(835),h=n(237);function p(e,t){let n=`${window.location.pathname}?section=${e}`;t&&(n+=`&template=${t}`),window.history.pushState({},"",n)}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("vault-input"),t=document.getElementById("new-template-btn"),n=document.getElementById("export-template-btn"),c=document.getElementById("import-template-btn"),m=document.getElementById("reset-default-template-btn");function f(){const e=document.getElementById("general-section"),t=document.getElementById("templates-section");e&&(e.style.display="block",e.classList.add("active")),t&&(t.style.display="none",t.classList.remove("active")),p("general"),document.querySelectorAll(".sidebar li").forEach((e=>e.classList.remove("active")));const n=document.querySelector('.sidebar li[data-section="general"]');n&&n.classList.add("active")}e?e.addEventListener("keypress",(t=>{if("Enter"===t.key){t.preventDefault();const n=e.value.trim();n&&((0,i.C_)(n),e.value="")}})):console.error("Vault input not found"),(0,i.YR)(),(0,r.K8)().then((()=>{!function(){const e=document.getElementById("template-list");e?e.addEventListener("click",(e=>{const t=e.target.closest("li");if(t&&t.dataset.id){const e=(0,r.yv)().find((e=>e.id===t.dataset.id));e&&((0,r.Do)(),(0,r.XM)(e),p("templates",e.id))}})):console.error("Template list not found"),t&&t.addEventListener("click",(()=>{(0,r.XM)(null)}))}(),function(){const e=new URLSearchParams(window.location.search),t=e.get("section"),n=e.get("template");if("general"===t)f();else if(n){const e=(0,r.Gw)(n);e?(0,r.XM)(e):(console.error(`Template with id ${n} not found`),f())}else f()}()})),function(){const e=document.querySelector(".sidebar");e&&e.addEventListener("click",(e=>{"general"===e.target.dataset.section&&f()}))}(),o(),(0,a.hf)(),function(){const e=document.getElementById("template-drop-zone"),t=document.body;if(!e)return void console.error("Drop zone not found");let n=0;function r(e){var t;if(null===(t=e.dataTransfer)||void 0===t?void 0:t.types)for(let t=0;t<e.dataTransfer.types.length;t++)if("Files"===e.dataTransfer.types[t])return!0;return!1}t.addEventListener("dragenter",(function(t){t.preventDefault(),t.stopPropagation(),n++,r(t)&&(null==e||e.classList.add("drag-over"))}),!1),t.addEventListener("dragleave",(function(t){t.preventDefault(),t.stopPropagation(),n--,0===n&&(null==e||e.classList.remove("drag-over"))}),!1),t.addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation()}),!1),t.addEventListener("drop",(function(t){var i;if(t.preventDefault(),t.stopPropagation(),null==e||e.classList.remove("drag-over"),n=0,r(t)){const e=null===(i=t.dataTransfer)||void 0===i?void 0:i.files;e&&e.length&&function(e){Array.from(e).forEach(d)}(e)}}),!1)}(),n.addEventListener("click",s),c.addEventListener("click",l),m.addEventListener("click",(function(){const e=(0,r.e2)(),t=(0,r.yv)(),n=t.findIndex((e=>"Default"===e.name));-1!==n?t[n]=e:t.unshift(e),(0,r.tR)().then((()=>{(0,r.wK)(),(0,r.XM)(e)})).catch((e=>{console.error("Failed to reset default template:",e),alert("Failed to reset default template. Please try again.")}))})),(0,u.Tzs)({icons:h.Pt})}))},237:(e,t,n)=>{n.d(t,{R9:()=>E,Pt:()=>y,vY:()=>b});const r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},i=["svg",r,[["path",{d:"M3 6h18"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17"}]]],a=["svg",r,[["line",{x1:"21",x2:"3",y1:"6",y2:"6"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18"}]]],o=["svg",r,[["rect",{x:"14",y:"14",width:"4",height:"6",rx:"2"}],["rect",{x:"6",y:"4",width:"4",height:"6",rx:"2"}],["path",{d:"M6 20h4"}],["path",{d:"M14 10h4"}],["path",{d:"M6 14h2v6"}],["path",{d:"M14 4h2v6"}]]],s=["svg",r,[["line",{x1:"8",x2:"21",y1:"6",y2:"6"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18"}]]],l=["svg",r,[["path",{d:"M8 2v4"}],["path",{d:"M16 2v4"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M3 10h18"}]]],c=["svg",r,[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 16 14"}]]],d=["svg",r,[["circle",{cx:"12",cy:"12",r:"1"}],["circle",{cx:"19",cy:"12",r:"1"}],["circle",{cx:"5",cy:"12",r:"1"}]]],u=["svg",r,[["path",{d:"m9 11 3 3L22 4"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"}]]],h=["svg",r,[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]]],p=["svg",r,[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]]],m=["svg",r,[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]]],f=["svg",r,[["path",{d:"m9 18 6-6-6-6"}]]],g=["svg",r,[["path",{d:"m6 9 6 6 6-6"}]]];var v=n(835);const y={Trash2:i,AlignLeft:a,Binary:o,List:s,Calendar:l,Clock:c,Ellipsis:d,SquareCheckBig:u,GripVertical:h,Settings:p,X:m,ChevronRight:f,ChevronDown:g};function b(e=document){(0,v.Tzs)({icons:y,attrs:{"stroke-width":1.75,class:"lucide-icon"},nameAttr:"data-lucide"})}function E(e){return{text:"align-left",multitext:"list",number:"binary",checkbox:"square-check-big",date:"calendar",datetime:"clock"}[e]||"align-left"}},213:(e,t,n)=>{n.d(t,{C_:()=>h,Sz:()=>l,YR:()=>p,q5:()=>c,zv:()=>d,Yb:()=>u});var r=n(102),i=n(237),a=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function o(e,t){t.checked?e.classList.add("is-enabled"):e.classList.remove("is-enabled")}n(436);var s=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};let l={showMoreActionsButton:!0,vaults:[]};function c(){return s(this,void 0,void 0,(function*(){var e;const t=yield chrome.storage.sync.get(["general_settings","vaults"]);return console.log("Loaded general settings:",t.general_settings),console.log("Loaded vaults:",t.vaults),l=Object.assign(Object.assign({},t.general_settings),{vaults:t.vaults||[],showMoreActionsButton:(null===(e=t.general_settings)||void 0===e?void 0:e.showMoreActionsButton)||!0}),l}))}function d(e){return s(this,void 0,void 0,(function*(){l=Object.assign(Object.assign({},l),e),yield chrome.storage.sync.set({general_settings:{showMoreActionsButton:l.showMoreActionsButton},vaults:l.vaults}),console.log("Saved general settings:",l)}))}function u(){const e=document.getElementById("vault-list");e&&(e.innerHTML="",l.vaults.forEach(((t,n)=>{const i=document.createElement("li");i.innerHTML=`\n\t\t\t<div class="drag-handle">\n\t\t\t\t<i data-lucide="grip-vertical"></i>\n\t\t\t</div>\n\t\t\t<span>${t}</span>\n\t\t\t<button type="button" class="remove-vault-btn clickable-icon" aria-label="Remove vault">\n\t\t\t\t<i data-lucide="trash-2"></i>\n\t\t\t</button>\n\t\t`,i.dataset.index=n.toString(),i.draggable=!0,i.addEventListener("dragstart",r.bS),i.addEventListener("dragover",r.ji),i.addEventListener("drop",r.MS),i.addEventListener("dragend",r.S5),i.querySelector(".remove-vault-btn").addEventListener("click",(e=>{e.stopPropagation(),function(e){l.vaults.splice(e,1),d(),u()}(n)})),e.appendChild(i)})),(0,i.vY)(e))}function h(e){l.vaults.push(e),d(),u()}function p(){c().then((()=>{u(),function(){const e=document.getElementById("show-more-actions-toggle");e&&(e.checked=l.showMoreActionsButton,e.addEventListener("change",(()=>{d({showMoreActionsButton:e.checked})})))}(),function(){const e=document.getElementById("vault-input");e&&e.addEventListener("keypress",(t=>{if("Enter"===t.key){t.preventDefault();const n=e.value.trim();n&&(h(n),e.value="")}}))}(),function(){const e=document.getElementById("keyboard-shortcuts-list");e&&function(){return a(this,void 0,void 0,(function*(){return new Promise((e=>{chrome.commands.getAll((t=>{e(t.map((e=>({name:e.name||"",description:e.description||"Open clipper",shortcut:e.shortcut||null}))))}))}))}))}().then((t=>{t.forEach((t=>{const n=document.createElement("div");n.className="shortcut-item",n.innerHTML=`\n\t\t\t\t<span>${t.description}</span>\n\t\t\t\t<span class="setting-hotkey">${t.shortcut||"Not set"}</span>\n\t\t\t`,e.appendChild(n)}))}))}(),document.querySelectorAll(".checkbox-container").forEach((e=>{const t=e.querySelector('input[type="checkbox"]');t&&(o(e,t),t.addEventListener("change",(()=>{o(e,t)})),e.addEventListener("click",(e=>{e.preventDefault(),t.checked=!t.checked,t.dispatchEvent(new Event("change"))})))}))}))}},436:(e,t,n)=>{n.d(t,{JE:()=>T,e2:()=>A,H0:()=>u,Gw:()=>D,d8:()=>L,yv:()=>x,K8:()=>v,Do:()=>C,tR:()=>N,XM:()=>E,kT:()=>d,G_:()=>w,wK:()=>b});var r=n(102),i=n(237),a=n(633),o=n(992),s=n(213),l=n(783),c=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};let d=[],u=-1;const h="template_",p="template_list",m=8e3,f=6e3;let g=!1;function v(){return new Promise((e=>{chrome.storage.sync.get(p,(t=>c(this,void 0,void 0,(function*(){const n=t[p]||[];d=[];for(const e of n){const t=yield y(e);t&&d.push(t)}0===d.length&&d.push(A()),b(),e()}))))}))}function y(e){return c(this,void 0,void 0,(function*(){return new Promise((t=>{chrome.storage.sync.get(h+e,(n=>{const r=n[h+e];if(r){const e=(0,o.decompressFromUTF16)(r.join(""));t(JSON.parse(e))}else t(null)}))}))}))}function b(){const e=document.getElementById("template-list");e&&(e.innerHTML="",d.forEach(((t,n)=>{if(t&&t.name&&t.id){const r=document.createElement("li");r.innerHTML=`\n\t\t\t\t<div class="drag-handle">\n\t\t\t\t\t<i data-lucide="grip-vertical"></i>\n\t\t\t\t</div>\n\t\t\t\t<span class="template-name">${t.name}</span>\n\t\t\t\t<button type="button" class="delete-template-btn clickable-icon" aria-label="Delete template">\n\t\t\t\t\t<i data-lucide="trash-2"></i>\n\t\t\t\t</button>\n\t\t\t`,r.dataset.id=t.id,r.dataset.index=n.toString(),r.draggable=!0,r.addEventListener("click",(e=>{e.target.closest(".delete-template-btn")||E(t)}));const i=r.querySelector(".delete-template-btn");i&&i.addEventListener("click",(e=>{e.stopPropagation(),function(e){const t=d.findIndex((t=>t.id===e));if(-1!==t&&confirm(`Are you sure you want to delete the template "${d[t].name}"?`)){if(d.splice(t,1),u===t)if(d.length>0){const e=Math.max(0,t-1);E(d[e])}else!function(){u=-1;const e=document.getElementById("template-editor-title"),t=document.getElementById("template-name"),n=document.getElementById("template-properties");e&&(e.textContent="New template"),t&&(t.value=""),n&&(n.innerHTML="");const r=document.getElementById("template-path-name");r&&(r.value="Clippings");const i=document.getElementById("url-patterns");i&&(i.value="");const a=document.getElementById("template-editor");a&&(a.style.display="none")}();else u>t&&u--;N(),b()}}(t.id)})),n===u&&r.classList.add("active"),e.appendChild(r)}else console.error("Invalid template at index",n,":",t)})),(0,i.vY)(e))}function E(e){let t;e?(t=e,u=d.findIndex((e=>e.id===t.id))):(t={id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"New template",behavior:"create",noteNameFormat:"{{title}}",path:"Clippings",noteContentFormat:"{{content}}",properties:[],triggers:[]},d.push(t),u=d.length-1,N().then((()=>{b()})).catch((e=>{console.error("Failed to save new template:",e)}))),t.properties||(t.properties=[]);const n=document.getElementById("template-editor-title"),r=document.getElementById("template-name"),i=document.getElementById("template-properties");n&&(n.textContent="Edit template"),r&&(r.value=t.name),i&&(i.innerHTML="");const a=document.getElementById("template-path-name");a&&(a.value=t.path);const o=document.getElementById("template-behavior");document.getElementById("specific-note-container"),document.getElementById("daily-note-format-container"),document.getElementById("note-name-format-container"),document.getElementById("properties-container"),document.getElementById("properties-warning"),o&&(o.value=t.behavior||"create");const c=document.getElementById("specific-note-name");c&&(c.value=t.specificNoteName||"");const h=document.getElementById("daily-note-format");h&&(h.value=t.dailyNoteFormat||"YYYY-MM-DD");const p=document.getElementById("note-name-format");p&&(p.value=t.noteNameFormat||"{{title}}");const m=document.getElementById("note-content-format");m&&(m.value=t.noteContentFormat||""),I(),o&&o.addEventListener("change",I),t&&Array.isArray(t.properties)&&t.properties.forEach((e=>T(e.name,e.value,e.type,e.id)));const f=document.getElementById("url-patterns");f&&(f.value=t&&t.triggers?t.triggers.join("\n"):"");const v=document.getElementById("template-editor");v&&(v.style.display="block");const y=document.getElementById("templates-section");y&&(y.style.display="block");const E=document.getElementById("general-section");if(E&&(E.style.display="none"),document.querySelectorAll(".sidebar li[data-section]").forEach((e=>e.classList.remove("active"))),document.querySelectorAll("#template-list li").forEach((e=>e.classList.remove("active"))),-1!==u){const e=document.querySelector(`#template-list li[data-id="${d[u].id}"]`);e&&e.classList.add("active")}if(y&&y.classList.add("active"),E&&E.classList.remove("active"),b(),!t.id){const e=document.getElementById("template-name");e&&(e.focus(),e.select())}C(),r&&r.addEventListener("input",function(e){let t=null;return function(...n){const r=this;t&&clearTimeout(t),t=setTimeout((()=>e.apply(r,n)),200)}}((()=>{-1!==u&&d[u]&&(d[u].name=r.value,b(),g=!0)})));const _=document.getElementById("template-vault");_&&(_.innerHTML='<option value="">Last used</option>',s.Sz.vaults.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,_.appendChild(t)})),_.value=t.vault||""),g=!0,(0,l.b)("templates",t.id)}function _(e){return c(this,void 0,void 0,(function*(){const t=(0,o.compressToUTF16)(JSON.stringify(e)),n=[];for(let e=0;e<t.length;e+=m)n.push(t.slice(e,e+m));return t.length>f?[n,`Warning: Template "${e.name}" is ${(t.length/1024).toFixed(2)}KB, which is approaching the storage limit.`]:[n,null]}))}function N(){return new Promise(((e,t)=>c(this,void 0,void 0,(function*(){try{const n=d.map((e=>e.id)),r=[],i={};for(const e of d){const[t,n]=yield _(e);i[h+e.id]=t,n&&r.push(n)}chrome.storage.sync.set(Object.assign(Object.assign({},i),{[p]:n}),(()=>{chrome.runtime.lastError?(console.error("Error saving templates:",chrome.runtime.lastError),t(chrome.runtime.lastError)):(console.log("Template settings saved"),g=!1,e(r))}))}catch(e){console.error("Error preparing templates for save:",e),t(e)}}))))}function A(){return{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"Default",behavior:"create",noteNameFormat:"{{title}}",path:"Clippings",noteContentFormat:"{{content}}",properties:[{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"title",value:"{{title}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"source",value:"{{url}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"author",value:"{{author|wikilink}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"published",value:"{{published}}",type:"date"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"created",value:"{{date}}",type:"date"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"description",value:"{{description}}",type:"text"},{id:Date.now().toString()+Math.random().toString(36).slice(2,11),name:"tags",value:"clippings",type:"multitext"}],triggers:[]}}function T(e="",t="",n="text",o=null){const s=document.getElementById("template-properties");if(!s)return;const l=document.createElement("div");var c;l.className="property-editor",l.innerHTML=`\n\t\t<div class="drag-handle">\n\t\t\t<i data-lucide="grip-vertical"></i>\n\t\t</div>\n\t\t<div class="property-select">\n\t\t\t<div class="property-selected" data-value="${n}">\n\t\t\t\t<i data-lucide="${(0,i.R9)(n)}"></i>\n\t\t\t</div>\n\t\t\t<select class="property-type">\n\t\t\t\t<option value="text">Text</option>\n\t\t\t\t<option value="multitext">List</option>\n\t\t\t\t<option value="number">Number</option>\n\t\t\t\t<option value="checkbox">Checkbox</option>\n\t\t\t\t<option value="date">Date</option>\n\t\t\t\t<option value="datetime">Date & time</option>\n\t\t\t</select>\n\t\t</div>\n\t\t<input type="text" class="property-name" value="${e}" placeholder="Property name">\n\t\t<input type="text" class="property-value" value="${c=(0,a.MG)(t),c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}" placeholder="Property value">\n\t\t<button type="button" class="remove-property-btn clickable-icon" aria-label="Remove property">\n\t\t\t<i data-lucide="trash-2"></i>\n\t\t</button>\n\t`,l.dataset.id=o||Date.now().toString()+Math.random().toString(36).slice(2,11),s.appendChild(l),l.addEventListener("mousedown",(e=>{e.target.closest("input, select, button")||(l.setAttribute("draggable","true"),s.querySelectorAll(".property-editor").forEach((e=>{e!==l&&e.setAttribute("draggable","true")})))}));const d=()=>{l.removeAttribute("draggable"),s.querySelectorAll(".property-editor").forEach((e=>{e.removeAttribute("draggable")}))};l.addEventListener("dragend",d),l.addEventListener("mouseup",d);const u=l.querySelector(".property-select");if(!u)return;const h=u.querySelector(".property-selected"),p=u.querySelector("select");p&&(p.value=n,p.addEventListener("change",(function(){h&&S(this.value,h)})));const m=l.querySelector(".remove-property-btn");m&&m.addEventListener("click",(()=>{s.removeChild(l)})),l.addEventListener("dragstart",r.bS),l.addEventListener("dragover",r.ji),l.addEventListener("drop",r.MS),l.addEventListener("dragend",r.S5),h&&S(n,h),(0,i.vY)(l)}function S(e,t){const n=(0,i.R9)(e);t.innerHTML=`<i data-lucide="${n}"></i>`,t.setAttribute("data-value",e),(0,i.vY)(t)}function w(){if(-1===u)return;const e=d[u];if(!e)return void console.error("Template not found");const t=document.getElementById("template-behavior");t&&(e.behavior=t.value);const n=document.getElementById("template-path-name");n&&(e.path=n.value);const r=document.getElementById("note-name-format");r&&(e.noteNameFormat=r.value);const i=document.getElementById("specific-note-name");i&&(e.specificNoteName=i.value);const o=document.getElementById("daily-note-format");o&&(e.dailyNoteFormat=o.value);const s=document.getElementById("note-content-format");s&&(e.noteContentFormat=s.value);const l=document.querySelectorAll("#template-properties .property-editor");e.properties=Array.from(l).map((e=>{const t=e.querySelector(".property-name"),n=e.querySelector(".property-value"),r=e.querySelector(".property-select .property-selected");return{id:e.dataset.id||Date.now().toString()+Math.random().toString(36).slice(2,11),name:t.value,value:(0,a.PI)(n.value),type:r.getAttribute("data-value")||"text"}}));const c=document.getElementById("url-patterns");c&&(e.triggers=c.value.split("\n").filter(Boolean));const h=document.getElementById("template-vault");h&&(e.vault=h.value||void 0),g=!0}function C(){g=!1}function L(){return u}function x(){return d}function I(){const e=document.getElementById("template-behavior"),t=document.getElementById("specific-note-container"),n=document.getElementById("daily-note-format-container"),r=document.getElementById("note-name-format-container"),i=document.getElementById("properties-container"),a=document.getElementById("properties-warning");if(e){const o=e.value;t&&(t.style.display="append-specific"===o?"block":"none"),n&&(n.style.display="append-daily"===o?"block":"none"),r&&(r.style.display="create"===o?"block":"none"),"append-specific"===o||"append-daily"===o?(i&&(i.style.display="none"),a&&(a.style.display="block")):(i&&(i.style.display="block"),a&&(a.style.display="none"))}}function D(e){return d.find((t=>t.id===e))}},102:(e,t,n)=>{n.d(t,{MS:()=>c,S5:()=>d,bS:()=>s,hf:()=>o,ji:()=>l});var r=n(436),i=n(213);let a=null;function o(){[document.getElementById("template-list"),document.getElementById("template-properties"),document.getElementById("vault-list")].forEach((e=>{e&&(e.addEventListener("dragstart",s),e.addEventListener("dragover",l),e.addEventListener("drop",c),e.addEventListener("dragend",d))}))}function s(e){e.stopPropagation(),a=e.target.closest("[draggable]"),a&&e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a.dataset.id||a.dataset.index||""),setTimeout((()=>{a&&a.classList.add("dragging")}),0))}function l(e){var t,n;e.stopPropagation(),e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");const r=e.target.closest("[draggable]");if(r&&r!==a&&a){const i=r.getBoundingClientRect(),o=i.top+i.height/2;e.clientY<o?null===(t=r.parentNode)||void 0===t||t.insertBefore(a,r):null===(n=r.parentNode)||void 0===n||n.insertBefore(a,r.nextSibling)}}function c(e){if(e.stopPropagation(),e.preventDefault(),!e.dataTransfer)return;const t=e.dataTransfer.getData("text/plain"),n=e.target.closest("ul, #template-properties");if(n&&a){const e=Array.from(n.children).indexOf(a);"template-list"===n.id?function(e,t){const n=(0,r.yv)(),i=n.findIndex((t=>t.id===e));if(-1!==i&&i!==t){const[e]=n.splice(i,1);n.splice(t,0,e),(0,r.tR)().then((()=>{(0,r.wK)()})).catch((e=>{console.error("Failed to save template settings:",e)}))}}(t,e):"template-properties"===n.id?function(e,t){const n=(0,r.d8)();if(-1===n)return void console.error("No template is currently being edited");const i=(0,r.yv)()[n];if(!i)return void console.error("Template not found");if(!Array.isArray(i.properties)||0===i.properties.length)return void console.error("Template properties array is empty or not an array");const a=i.properties.findIndex((t=>t.id===e));if(-1!==a){if(a!==t){const[e]=i.properties.splice(a,1);i.properties.splice(t,0,e),(0,r.tR)().then((()=>{(0,r.wK)()})).catch((e=>{console.error("Failed to save template settings:",e)}))}}else console.error("Property not found")}(t,e):"vault-list"===n.id&&function(e){if(!a)return;const t=parseInt(a.dataset.index||"-1");if(-1!==t&&t!==e){const[n]=i.Sz.vaults.splice(t,1);i.Sz.vaults.splice(e,0,n),(0,i.zv)(),(0,i.Yb)()}}(e),a.classList.remove("dragging")}a=null}function d(){a&&a.classList.remove("dragging"),a=null}},633:(e,t,n)=>{function r(e){return e.replace(/"/g,'\\"').replace(/\n/g,"\\n")}function i(e){return e.replace(/\\"/g,'"').replace(/\\n/g,"\n")}function a(e){return Object.entries(e).map((([e,t])=>`\n\t\t\t<div class="variable-item is-collapsed">\n\t\t\t\t<span class="variable-key" data-variable="${o(e)}">${o(e)}</span>\n\t\t\t\t<span class="variable-value">${o(t)}</span>\n\t\t\t\t<span class="chevron-icon" aria-label="Expand">\n\t\t\t\t\t<i data-lucide="chevron-right"></i>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t `)).join("")}function o(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}n.d(t,{MG:()=>i,PI:()=>r,f0:()=>a})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=n(353),i=n.n(r);function a(e){return navigator.platform.indexOf("Win")>-1?e.replace(":","").replace(/[/\\?%*|"<>]/g,"-"):e.replace(":","").replace(/[/\\]/g,"-")}function o(e,t){return Array(t+1).join(e)}var s=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function l(e){return h(e,s)}var c=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function d(e){return h(e,c)}var u=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function h(e,t){return t.indexOf(e.nodeName)>=0}function p(e,t){return e.getElementsByTagName&&t.some((function(t){return e.getElementsByTagName(t).length}))}var m={};function f(e){return e?e.replace(/(\n+\s*)+/g,"\n"):""}function g(e){for(var t in this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[],e.rules)this.array.push(e.rules[t])}function v(e,t,n){for(var r=0;r<e.length;r++){var i=e[r];if(y(i,t,n))return i}}function y(e,t,n){var r=e.filter;if("string"==typeof r){if(r===t.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(t.nodeName.toLowerCase())>-1)return!0}else{if("function"!=typeof r)throw new TypeError("`filter` needs to be a string, array, or function");if(r.call(e,t,n))return!0}}function b(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function E(e,t,n){return e&&e.parentNode===t||n(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}m.paragraph={filter:"p",replacement:function(e){return"\n\n"+e+"\n\n"}},m.lineBreak={filter:"br",replacement:function(e,t,n){return n.br+"\n"}},m.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,n){var r=Number(t.nodeName.charAt(1));return"setext"===n.headingStyle&&r<3?"\n\n"+e+"\n"+o(1===r?"=":"-",e.length)+"\n\n":"\n\n"+o("#",r)+" "+e+"\n\n"}},m.blockquote={filter:"blockquote",replacement:function(e){return"\n\n"+(e=(e=e.replace(/^\n+|\n+$/g,"")).replace(/^/gm,"> "))+"\n\n"}},m.list={filter:["ul","ol"],replacement:function(e,t){var n=t.parentNode;return"LI"===n.nodeName&&n.lastElementChild===t?"\n"+e:"\n\n"+e+"\n\n"}},m.listItem={filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");var r=n.bulletListMarker+"   ",i=t.parentNode;if("OL"===i.nodeName){var a=i.getAttribute("start"),o=Array.prototype.indexOf.call(i.children,t);r=(a?Number(a)+o:o+1)+".  "}return r+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}},m.indentedCodeBlock={filter:function(e,t){return"indented"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},m.fencedCodeBlock={filter:function(e,t){return"fenced"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){for(var r,i=((t.firstChild.getAttribute("class")||"").match(/language-(\S+)/)||[null,""])[1],a=t.firstChild.textContent,s=n.fence.charAt(0),l=3,c=new RegExp("^"+s+"{3,}","gm");r=c.exec(a);)r[0].length>=l&&(l=r[0].length+1);var d=o(s,l);return"\n\n"+d+i+"\n"+a.replace(/\n$/,"")+"\n"+d+"\n\n"}},m.horizontalRule={filter:"hr",replacement:function(e,t,n){return"\n\n"+n.hr+"\n\n"}},m.inlineLink={filter:function(e,t){return"inlined"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t){var n=t.getAttribute("href");n&&(n=n.replace(/([()])/g,"\\$1"));var r=f(t.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+e+"]("+n+r+")"}},m.referenceLink={filter:function(e,t){return"referenced"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t,n){var r,i,a=t.getAttribute("href"),o=f(t.getAttribute("title"));switch(o&&(o=' "'+o+'"'),n.linkReferenceStyle){case"collapsed":r="["+e+"][]",i="["+e+"]: "+a+o;break;case"shortcut":r="["+e+"]",i="["+e+"]: "+a+o;break;default:var s=this.references.length+1;r="["+e+"]["+s+"]",i="["+s+"]: "+a+o}return this.references.push(i),r},references:[],append:function(e){var t="";return this.references.length&&(t="\n\n"+this.references.join("\n")+"\n\n",this.references=[]),t}},m.emphasis={filter:["em","i"],replacement:function(e,t,n){return e.trim()?n.emDelimiter+e+n.emDelimiter:""}},m.strong={filter:["strong","b"],replacement:function(e,t,n){return e.trim()?n.strongDelimiter+e+n.strongDelimiter:""}},m.code={filter:function(e){var t=e.previousSibling||e.nextSibling,n="PRE"===e.parentNode.nodeName&&!t;return"CODE"===e.nodeName&&!n},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",n="`",r=e.match(/`+/gm)||[];-1!==r.indexOf(n);)n+="`";return n+t+e+t+n}},m.image={filter:"img",replacement:function(e,t){var n=f(t.getAttribute("alt")),r=t.getAttribute("src")||"",i=f(t.getAttribute("title"));return r?"!["+n+"]("+r+(i?' "'+i+'"':"")+")":""}},g.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){return e.isBlank?this.blankRule:(t=v(this.array,e,this.options))||(t=v(this._keep,e,this.options))||(t=v(this._remove,e,this.options))?t:this.defaultRule;var t},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};var _,N,A="undefined"!=typeof window?window:{},T=function(){var e=A.DOMParser,t=!1;try{(new e).parseFromString("","text/html")&&(t=!0)}catch(e){}return t}()?A.DOMParser:(_=function(){},function(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch(t){A.ActiveXObject&&(e=!0)}return e}()?_.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:_.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},_);function S(e,t){var n;return function(e){var t=e.element,n=e.isBlock,r=e.isVoid,i=e.isPre||function(e){return"PRE"===e.nodeName};if(t.firstChild&&!i(t)){for(var a=null,o=!1,s=null,l=E(s,t,i);l!==t;){if(3===l.nodeType||4===l.nodeType){var c=l.data.replace(/[ \r\n\t]+/g," ");if(a&&!/ $/.test(a.data)||o||" "!==c[0]||(c=c.substr(1)),!c){l=b(l);continue}l.data=c,a=l}else{if(1!==l.nodeType){l=b(l);continue}n(l)||"BR"===l.nodeName?(a&&(a.data=a.data.replace(/ $/,"")),a=null,o=!1):r(l)||i(l)?(a=null,o=!0):a&&(o=!1)}var d=E(s,l,i);s=l,l=d}a&&(a.data=a.data.replace(/ $/,""),a.data||b(a))}}({element:n="string"==typeof e?(N=N||new T).parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html").getElementById("turndown-root"):e.cloneNode(!0),isBlock:l,isVoid:d,isPre:t.preformattedCode?w:null}),n}function w(e){return"PRE"===e.nodeName||"CODE"===e.nodeName}function C(e,t){return e.isBlock=l(e),e.isCode="CODE"===e.nodeName||e.parentNode.isCode,e.isBlank=function(e){return!d(e)&&!function(e){return h(e,u)}(e)&&/^\s*$/i.test(e.textContent)&&!function(e){return p(e,c)}(e)&&!function(e){return p(e,u)}(e)}(e),e.flankingWhitespace=function(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var n,r={leading:(n=e.textContent.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/))[1],leadingAscii:n[2],leadingNonAscii:n[3],trailing:n[4],trailingNonAscii:n[5],trailingAscii:n[6]};return r.leadingAscii&&L("left",e,t)&&(r.leading=r.leadingNonAscii),r.trailingAscii&&L("right",e,t)&&(r.trailing=r.trailingNonAscii),{leading:r.leading,trailing:r.trailing}}(e,t),e}function L(e,t,n){var r,i,a;return"left"===e?(r=t.previousSibling,i=/ $/):(r=t.nextSibling,i=/^ /),r&&(3===r.nodeType?a=i.test(r.nodeValue):n.preformattedCode&&"CODE"===r.nodeName?a=!1:1!==r.nodeType||l(r)||(a=i.test(r.textContent))),a}var x=Array.prototype.reduce,I=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function D(e){if(!(this instanceof D))return new D(e);var t={rules:m,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(e,t){return t.isBlock?"\n\n":""},keepReplacement:function(e,t){return t.isBlock?"\n\n"+t.outerHTML+"\n\n":t.outerHTML},defaultReplacement:function(e,t){return t.isBlock?"\n\n"+e+"\n\n":e}};this.options=function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e}({},t,e),this.rules=new g(this.options)}function O(e){var t=this;return x.call(e.childNodes,(function(e,n){var r="";return 3===(n=new C(n,t.options)).nodeType?r=n.isCode?n.nodeValue:t.escape(n.nodeValue):1===n.nodeType&&(r=k.call(t,n)),B(e,r)}),"")}function M(e){var t=this;return this.rules.forEach((function(n){"function"==typeof n.append&&(e=B(e,n.append(t.options)))})),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function k(e){var t=this.rules.forNode(e),n=O.call(this,e),r=e.flankingWhitespace;return(r.leading||r.trailing)&&(n=n.trim()),r.leading+t.replacement(n,e,this.options)+r.trailing}function B(e,t){var n=function(e){for(var t=e.length;t>0&&"\n"===e[t-1];)t--;return e.substring(0,t)}(e),r=t.replace(/^\n*/,""),i=Math.max(e.length-n.length,t.length-r.length);return n+"\n\n".substring(0,i)+r}D.prototype={turndown:function(e){if(!function(e){return null!=e&&("string"==typeof e||e.nodeType&&(1===e.nodeType||9===e.nodeType||11===e.nodeType))}(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(""===e)return"";var t=O.call(this,new S(e,this.options));return M.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else{if("function"!=typeof e)throw new TypeError("plugin must be a Function or an Array of Functions");e(this)}return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return I.reduce((function(e,t){return e.replace(t[0],t[1])}),e)}};const $=D;var R=/highlight-(?:text|source)-([a-z0-9]+)/;function P(e){e.addRule("highlightedCodeBlock",{filter:function(e){var t=e.firstChild;return"DIV"===e.nodeName&&R.test(e.className)&&t&&"PRE"===t.nodeName},replacement:function(e,t,n){var r=((t.className||"").match(R)||[null,""])[1];return"\n\n"+n.fence+r+"\n"+t.firstChild.textContent+"\n"+n.fence+"\n\n"}})}function H(e){e.addRule("strikethrough",{filter:["del","s","strike"],replacement:function(e){return"~"+e+"~"}})}var F=Array.prototype.indexOf,U=Array.prototype.every,j={};function G(e){var t,n,r=e.parentNode;return"THEAD"===r.nodeName||r.firstChild===e&&("TABLE"===r.nodeName||(n=(t=r).previousSibling,"TBODY"===t.nodeName&&(!n||"THEAD"===n.nodeName&&/^\s*$/i.test(n.textContent))))&&U.call(e.childNodes,(function(e){return"TH"===e.nodeName}))}function W(e,t){var n=" ";return 0===F.call(t.parentNode.childNodes,t)&&(n="| "),n+e+" |"}function q(e){for(var t in e.keep((function(e){return"TABLE"===e.nodeName&&!G(e.rows[0])})),j)e.addRule(t,j[t])}function Y(e){e.addRule("taskListItems",{filter:function(e){return"checkbox"===e.type&&"LI"===e.parentNode.nodeName},replacement:function(e,t){return(t.checked?"[x]":"[ ]")+" "}})}function V(e){e.use([P,H,q,Y])}j.tableCell={filter:["th","td"],replacement:function(e,t){return W(e,t)}},j.tableRow={filter:"tr",replacement:function(e,t){var n="",r={left:":--",right:"--:",center:":-:"};if(G(t))for(var i=0;i<t.childNodes.length;i++){var a="---",o=(t.childNodes[i].getAttribute("align")||"").toLowerCase();o&&(a=r[o]||a),n+=W(a,t.childNodes[i])}return"\n"+e+(n?"\n"+n:"")}},j.table={filter:function(e){return"TABLE"===e.nodeName&&G(e.rows[0])},replacement:function(e){return"\n\n"+(e=e.replace("\n\n","\n"))+"\n\n"}},j.tableSection={filter:["thead","tbody","tfoot"],replacement:function(e){return e}};var J=n(396);const X={list:(e,t)=>{try{const n=JSON.parse(e);if(Array.isArray(n))switch(t){case"numbered":return n.map(((e,t)=>`${t+1}. ${e}`)).join("\n");case"task":return n.map((e=>`- [ ] ${e}`)).join("\n");case"numbered-task":return n.map(((e,t)=>`${t+1}. [ ] ${e}`)).join("\n");default:return n.map((e=>`- ${e}`)).join("\n")}}catch(e){console.error("Error parsing JSON for list filter:",e)}return e},camel:e=>e.replace(/(?:^\w|[A-Z]|\b\w)/g,((e,t)=>0===t?e.toLowerCase():e.toUpperCase())).replace(/[\s_-]+/g,""),kebab:e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),pascal:e=>e.replace(/[\s_-]+(.)/g,((e,t)=>t.toUpperCase())).replace(/^(.)/,(e=>e.toUpperCase())),snake:e=>e.replace(/([a-z])([A-Z])/g,"$1_$2").replace(/[\s-]+/g,"_").toLowerCase(),wikilink:e=>{if(!e.trim())return"";if(e.startsWith("[")&&e.endsWith("]"))try{const t=JSON.parse(e);if(Array.isArray(t))return t.map((e=>e.trim()?`[[${e}]]`:"")).filter(Boolean).join(", ")}catch(e){console.error("wikilink error:",e)}return`[[${e}]]`},slice:(e,t)=>{if(!t)return console.error("Slice filter requires parameters"),e;const[n,r]=t.split(",").map((e=>e.trim())).map((e=>{if(""===e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}));let i;try{i=JSON.parse(e)}catch(t){console.error("Error parsing JSON in slice filter:",t),i=e}if(Array.isArray(i)){const e=i.slice(n,r);return 1===e.length?e[0].toString():JSON.stringify(e)}return e.slice(n,r)},split:(e,t)=>{if(!t)return console.error("Split filter requires a separator parameter"),JSON.stringify([e]);const n=1===(t=t.replace(/^["']|["']$/g,"")).length?t:new RegExp(t),r=e.split(n);return JSON.stringify(r)},join:(e,t)=>{let n;try{n=JSON.parse(e)}catch(t){return console.error("Error parsing JSON in join filter:",t),e}return Array.isArray(n)?n.join(t||","):e},date:(e,t)=>{const n=i()(e);return n.isValid()?t?n.format(t):n.format():(console.error("Invalid date for date filter:",e),e)},trim:e=>e.trim(),first:e=>{try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0)return t[0].toString()}catch(e){console.error("Error parsing JSON in first filter:",e)}return e},last:e=>{try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0)return t[t.length-1].toString()}catch(e){console.error("Error parsing JSON in last filter:",e)}return e},capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),lower:e=>e.toLowerCase(),title:e=>e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())),upper:e=>e.toUpperCase(),quote:e=>e.split("\n").map((e=>`> ${e}`)).join("\n"),callout:(e,t)=>{let n="info",r="",i=null;if(t){const e=(t=t.replace(/^\((.*)\)$/,"$1")).split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map((e=>e.trim().replace(/^"|"$/g,"")));e.length>0&&(n=e[0]||n),e.length>1&&(r=e[1]||r),e.length>2&&("true"===e[2]?i="-":"false"===e[2]&&(i="+"))}let a=`> [!${n}]`;return i&&(a+=i),r&&(a+=` ${r}`),`${a}\n${e.split("\n").map((e=>`> ${e}`)).join("\n")}`}};function z(e,t){let n="string"==typeof e?e:JSON.stringify(e);return t.reduce(((e,t)=>{const n=t.match(/(\w+)(?::(.+)|"(.+)")?/);if(n){const[,t,r,i]=n,a=r||i?(r||i).replace(/^["']|["']$/g,""):void 0,o=X[t];if(o)return o(e,a)}else console.error(`Invalid filter format: ${t}`);return e}),n)}var K=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Z(e,t){return K(this,void 0,void 0,(function*(){const[,n]=e.match(/{{(.*?)}}/)||[],[r,...i]=n.split("|"),a=i.join("|");return z(t[`{{${r}}}`]||"",a.split("|").filter(Boolean))}))}function Q(e,t){return K(this,void 0,void 0,(function*(){const n=t.match(/{{selector:(.*?)(?:\|(.*?))?}}/);if(!n)return console.error("Invalid selector format:",t),t;const[,r,i]=n,{content:a}=yield function(e,t){return K(this,void 0,void 0,(function*(){return new Promise((n=>{const r=t.match(/:([a-zA-Z-]+)$/);let i,a=t;r&&(i=r[1],a=t.slice(0,-i.length-1)),chrome.tabs.sendMessage(e,{action:"extractContent",selector:a,attribute:i},(function(e){let t=e?e.content:"";Array.isArray(t)&&(t=JSON.stringify(t)),n({content:t,schemaOrgData:e?e.schemaOrgData:null})}))}))}))}(e,r),o=Array.isArray(a)?JSON.stringify(a):a;return i?z(o,i.split("|").map((e=>e.trim()))):o}))}function ee(e,t){return K(this,void 0,void 0,(function*(){const[,n]=e.match(/{{schema:(.*?)}}/)||[],[r,...i]=n.split("|"),a=i.join("|");let o="";const s=r.match(/(.*?)\.\[\*\]\.(.*)/);if(s){const[,e,n]=s,r=JSON.parse(t[`{{schema:${e}}}`]||"[]");Array.isArray(r)&&(o=JSON.stringify(r.map((e=>e[n])).filter(Boolean)))}else o=t[`{{schema:${r}}}`]||"";return z(o,a.split("|").filter(Boolean))}))}function te(e,t,n){return K(this,void 0,void 0,(function*(){const r=t.match(/{{(?:schema:)?(?:selector:)?(.*?)}}/g);if(r)for(const i of r){let r;r=i.startsWith("{{selector:")?yield Q(e,i):i.startsWith("{{schema:")?yield ee(i,n):yield Z(i,n),t=t.replace(i,r)}return t}))}function ne(e){return K(this,void 0,void 0,(function*(){return new Promise((t=>{chrome.tabs.sendMessage(e,{action:"getPageContent"},(function(e){e&&e.content?t({content:e.content,selectedHtml:e.selectedHtml,extractedContent:e.extractedContent,schemaOrgData:e.schemaOrgData}):t(null)}))}))}))}function re(e,t,n){var r,i;const a=`meta[${t}]`,o=Array.from(e.querySelectorAll(a)).find((e=>{var r;return(null===(r=e.getAttribute(t))||void 0===r?void 0:r.toLowerCase())===n.toLowerCase()}));return o&&null!==(i=null===(r=o.getAttribute("content"))||void 0===r?void 0:r.trim())&&void 0!==i?i:""}function ie(e,t,n,r,i){return K(this,void 0,void 0,(function*(){var o,s;const l=function(e){const t=(new DOMParser).parseFromString(e,"text/html");return new J.Readability(t).parse()}(e);if(!l)return console.error("Failed to parse content with Readability"),null;const c=(new DOMParser).parseFromString(e,"text/html"),d=re(c,"property","og:title")||re(c,"name","twitter:title")||re(c,"name","title")||(null===(s=null===(o=c.querySelector("title"))||void 0===o?void 0:o.textContent)||void 0===s?void 0:s.trim())||"",u=a(d),h=re(c,"name","author")||re(c,"property","author")||re(c,"name","twitter:creator")||re(c,"property","og:site_name")||re(c,"name","application-name")||re(c,"name","copyright")||"",p=re(c,"name","description")||re(c,"property","description")||re(c,"property","og:description")||re(c,"name","twitter:description")||"",m=new URL(r).hostname.replace(/^www\./,""),f=re(c,"property","og:image")||re(c,"name","twitter:image")||"",g=c.querySelector("time"),v=re(c,"property","article:published_time")||(null==g?void 0:g.getAttribute("datetime")),y=v?`${ae(new Date(v))}`:"",b=re(c,"property","og:site_name")||re(c,"name","application-name")||re(c,"name","copyright")||"",E=function(e,t,n){const r=(new DOMParser).parseFromString(e,"text/html"),i=new URL(t);function a(e,t){const n=e.getAttribute(t);if(n)if(n.startsWith("chrome-extension://")){const r=n.split("/").slice(3).join("/"),a=new URL(r,i).href;e.setAttribute(t,a)}else if(!(n.startsWith("http")||n.startsWith("data:")||n.startsWith("#")||n.startsWith("mailto:"))){const r=new URL(n,i).href;e.setAttribute(t,r)}}let o;if(n){const e=document.createElement("div");e.innerHTML=n,e.querySelectorAll("img").forEach((e=>a(e,"src"))),e.querySelectorAll("a").forEach((e=>a(e,"href"))),o=e.innerHTML}else{const e=new J.Readability(r).parse();if(!e)return console.error("Failed to parse content with Readability"),"";const{content:t}=e,n=document.createElement("div");n.innerHTML=t,n.querySelectorAll("img").forEach((e=>a(e,"src"))),n.querySelectorAll("a").forEach((e=>a(e,"href"))),o=n.innerHTML}const s=new $({headingStyle:"atx",hr:"---",bulletListMarker:"-",codeBlockStyle:"fenced",emDelimiter:"*"});s.use(V),s.keep(["iframe","video","audio"]),s.addRule("listItem",{filter:"li",replacement:function(e,t,n){e=e.trim();let r=n.bulletListMarker+" ",i=t.parentNode;if(i instanceof HTMLOListElement){let e=i.getAttribute("start"),n=Array.from(i.children).indexOf(t)+1;r=(e?Number(e)+n-1:n)+". "}return r+e+"\n"}}),s.addRule("embedToMarkdown",{filter:function(e){if(e instanceof HTMLIFrameElement){const t=e.getAttribute("src");return!(!t||!t.match(/(?:youtube\.com|youtu\.be)/)&&!t.match(/(?:twitter\.com|x\.com)/))}return!1},replacement:function(e,t){if(t instanceof HTMLIFrameElement){const e=t.getAttribute("src");if(e){const t=e.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:embed\/|watch\?v=)?([a-zA-Z0-9_-]+)/);if(t&&t[1])return`![](https://www.youtube.com/watch?v=${t[1]})`;const n=e.match(/(?:twitter\.com|x\.com)\/.*?(?:status|statuses)\/(\d+)/);if(n&&n[1])return`![](https://x.com/i/status/${n[1]})`}}return e}}),s.addRule("highlight",{filter:"mark",replacement:function(e){return"=="+e+"=="}}),s.addRule("strikethrough",{filter:e=>"DEL"===e.nodeName||"S"===e.nodeName||"STRIKE"===e.nodeName,replacement:function(e){return"~~"+e+"~~"}});let l=s.turndown(o);const c=l.match(/^# .+\n+/);return c&&(l=l.slice(c[0].length)),l.trim()}(e,r,t),_={"{{author}}":h,"{{content}}":E,"{{description}}":p,"{{domain}}":m,"{{image}}":f,"{{published}}":y,"{{site}}":b,"{{title}}":d,"{{noteName}}":u,"{{date}}":ae(new Date),"{{today}}":ae(new Date),"{{url}}":r};return Object.entries(n).forEach((([e,t])=>{_[`{{${e}}}`]=t})),c.querySelectorAll("meta").forEach((e=>{const t=e.getAttribute("name"),n=e.getAttribute("property"),r=e.getAttribute("content");t&&r&&(_[`{{meta:name:${t}}}`]=r),n&&r&&(_[`{{meta:property:${n}}}`]=r)})),i&&oe(i,_),console.log("Available variables:",_),{noteName:u,currentVariables:_}}))}function ae(e){return i()(e).format("YYYY-MM-DD")}function oe(e,t,n=""){if(Array.isArray(e)){const r=`{{schema:${n.slice(0,-1)}}}`;t[r]=JSON.stringify(e),1===e.length?oe(e[0],t,n):e.forEach(((e,r)=>{oe(e,t,`${n}[${r}].`)}))}else"object"==typeof e&&null!==e&&Object.entries(e).forEach((([e,r])=>{"string"==typeof r||"number"==typeof r||"boolean"==typeof r?t[`{{schema:${n}${e}}}`]=String(r):(Array.isArray(r)||"object"==typeof r&&null!==r)&&oe(r,t,`${n}${e}.`)}))}var se=n(237),le=n(633),ce=n(992);function de(e,t){return new Promise((n=>{chrome.storage.local.set({[e]:t},(()=>{n()}))}))}function ue(e){return new Promise((t=>{chrome.storage.local.get(e,(n=>{t(n[e])}))}))}function he(e,t,n){if(e.startsWith("schema:"))return function(e,t){const[,n,r]=e.match(/schema:(.+?)(?:=(.+))?$/)||[];if(!n)return!1;const i=pe(t,n);return r?Array.isArray(i)?i.includes(r):i===r:!!i}(e,n);if(!e.startsWith("/")||!e.endsWith("/"))return t.startsWith(e);try{return new RegExp(e.slice(1,-1)).test(t)}catch(t){return console.error(`Invalid regex pattern: ${e}`,t),!1}}function pe(e,t){if(Array.isArray(e)){for(const n of e){const e=pe(n,t);if(void 0!==e)return e}return}const n=t.split(".");let r=e;for(const e of n){if(!r||"object"!=typeof r||!(e in r))return;r=r[e]}return r}var me=n(213),fe=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};let ge=null,ve=[],ye={};function be(e){const t=document.querySelector(".error-message"),n=document.querySelector(".clipper");if(t&&n){t.textContent=e,t.style.display="block",n.style.display="none";const r=document.getElementById("open-settings");r&&(r.style.display="flex")}}function Ee(){return fe(this,void 0,void 0,(function*(){if(!ge)return;const e=document.getElementById("vault-select"),t=document.getElementById("note-content-field"),n=document.getElementById("note-name-field"),r=document.getElementById("path-name-field");if(!(e&&t&&n&&r))return void be("Some required fields are missing. Please try reloading the extension.");const a=ge.vault||e.value,o=t.value,s=n.value,l=r.value,c=Array.from(document.querySelectorAll(".metadata-property input")).map((e=>({name:e.id,value:e.value,type:e.getAttribute("data-type")||"text"})));let d;if("create"===ge.behavior){const e=yield function(e){return t=this,n=void 0,i=function*(){let t="---\n";for(const n of e)switch(t+=`${n.name}:`,n.type){case"multitext":let e;if(n.value.trim().startsWith('["')&&n.value.trim().endsWith('"]'))try{e=JSON.parse(n.value)}catch(t){e=n.value.split(",").map((e=>e.trim()))}else e=n.value.split(/,(?![^\[]*\]\])/).map((e=>e.trim()));e=e.filter((e=>""!==e)),e.length>0?(t+="\n",e.forEach((e=>{t+=`  - "${e}"\n`}))):t+="\n";break;case"number":const r=n.value.replace(/[^\d.-]/g,"");t+=r?` ${parseFloat(r)}\n`:"\n";break;case"checkbox":t+=` ${"true"===n.value.toLowerCase()||"1"===n.value}\n`;break;case"date":case"datetime":""!==n.value.trim()?t+=` "${n.value}"\n`:t+="\n";break;default:t+=""!==n.value.trim()?` "${n.value}"\n`:"\n"}return t+="---\n",t},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(c);d=e+o}else d=o;try{yield function(e,t,n,r,a,o,s){let l,c=e;if(n&&!n.endsWith("/")&&(n+="/"),"append-specific"===a||"append-daily"===a){let e;e="append-specific"===a?o:i()().format(s),l=`obsidian://new?file=${encodeURIComponent(n+e)}&append=true`,c="\n\n"+c}else l=`obsidian://new?file=${encodeURIComponent(n+t)}`;l+=`&content=${encodeURIComponent(c)}`;const d=r?`&vault=${encodeURIComponent(r)}`:"";l+=d,chrome.tabs.query({active:!0,currentWindow:!0},(function(e){const t=e[0];t&&t.id&&chrome.tabs.update(t.id,{url:l},(function(e){chrome.notifications.create({type:"basic",iconUrl:"icon.png",title:"Obsidian Clipper",message:'If prompted, select "Always allow" to open Obsidian automatically in the future.'})}))}))}(d,s,l,a,ge.behavior,ge.specificNoteName,ge.dailyNoteFormat),setTimeout((()=>window.close()),50)}catch(e){throw console.error("Error in handleClip:",e),be("Failed to save to Obsidian. Please try again."),e}}))}chrome.runtime.onMessage.addListener(((e,t,n)=>{if("triggerQuickClip"===e.action)return Ee().then((()=>{n({success:!0})})).catch((e=>{console.error("Error in handleClip:",e),n({success:!1,error:e.message})})),!0})),document.addEventListener("DOMContentLoaded",(function(){return fe(this,void 0,void 0,(function*(){(0,se.vY)();const e=document.getElementById("vault-container"),t=document.getElementById("vault-select"),n=document.getElementById("template-container"),r=document.getElementById("template-select");let o=[];chrome.storage.sync.get(["vaults"],(n=>{o=n.vaults||[],t.innerHTML="",o.forEach((e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)})),o.length>0?(e.style.display="block",t.value=o[0]):e.style.display="none"})),chrome.storage.sync.get(["template_list"],(e=>fe(this,void 0,void 0,(function*(){const t=e.template_list||[],i=yield Promise.all(t.map((e=>new Promise((t=>chrome.storage.sync.get(`template_${e}`,(n=>{const r=n[`template_${e}`];if(r){const e=(0,ce.decompressFromUTF16)(r.join(""));t(JSON.parse(e))}else t(null)})))))));ve=i.filter((e=>null!==e)),0!==ve.length?(r.innerHTML="",ve.forEach((e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,r.appendChild(t)})),chrome.tabs.query({active:!0,currentWindow:!0},(function(e){return fe(this,void 0,void 0,(function*(){if(!e[0].url||e[0].url.startsWith("chrome-extension://")||e[0].url.startsWith("chrome://")||e[0].url.startsWith("about:")||e[0].url.startsWith("file://"))return void be("This page cannot be clipped.");const t=e[0].url;if(e[0].id)try{const n=yield ne(e[0].id);if(n){const e=yield ie(n.content,n.selectedHtml,n.extractedContent,t,n.schemaOrgData);e?(ge=function(e,t,n){return t.find((t=>t.triggers&&t.triggers.some((t=>he(t,e,n)))))}(t,ve,n.schemaOrgData)||ve[0],ge&&(r.value=ge.name),yield c(ge,e.currentVariables,e.noteName,n.schemaOrgData)):be("Unable to initialize page content.")}else be("Unable to get page content. Try reloading the page.")}catch(e){console.error("Error in popup initialization:",e),e instanceof Error?be(`An error occurred: ${e.message}`):be("An unexpected error occurred")}}))})),ve.length>1&&(n.style.display="block")):console.error("No templates found in storage")})))),r.addEventListener("change",(function(){return fe(this,void 0,void 0,(function*(){if(ge=ve.find((e=>e.name===this.value))||null,ge){const e=yield chrome.tabs.query({active:!0,currentWindow:!0});if(e[0].id){const t=yield ne(e[0].id);if(t){const n=yield ie(t.content,t.selectedHtml,t.extractedContent,e[0].url,t.schemaOrgData);n?yield c(ge,n.currentVariables,n.noteName,t.schemaOrgData):be("Unable to initialize page content.")}else be("Unable to retrieve page content. Try reloading the page.")}}}))}));const s=document.getElementById("note-name-field");function l(e){e.style.minHeight="2rem",e.style.minHeight=e.scrollHeight+"px"}function c(e,t,n,r){return fe(this,void 0,void 0,(function*(){ye=t;const n=document.querySelector(".metadata-properties");n.innerHTML="";const c=yield chrome.tabs.query({active:!0,currentWindow:!0}),d=c[0].id,u=c[0].url||"";for(const r of e.properties){const e=document.createElement("div");e.className="metadata-property";let a=yield te(d,(0,le.MG)(r.value),t);switch(r.type){case"number":const e=a.replace(/[^\d.-]/g,"");a=e?parseFloat(e).toString():a;break;case"checkbox":a=("true"===a.toLowerCase()||"1"===a).toString();break;case"date":a=i()(a).isValid()?i()(a).format("YYYY-MM-DD"):a;break;case"datetime":a=i()(a).isValid()?i()(a).format("YYYY-MM-DD HH:mm:ss"):a}e.innerHTML=`\n\t\t\t\t<span class="metadata-property-icon"><i data-lucide="${(0,se.R9)(r.type)}"></i></span>\n\t\t\t\t<label for="${r.name}">${r.name}</label>\n\t\t\t\t<input id="${r.name}" type="text" value="${h=a,h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}" data-type="${r.type}" />\n\t\t\t`,n.appendChild(e)}var h;if(s){let n=yield te(d,e.noteNameFormat,t);s.value=a(n),l(s)}const p=document.getElementById("path-name-field");p&&(p.value=e.path);const m=document.getElementById("note-content-field");if(m)if(e.noteContentFormat){let n=yield te(d,e.noteContentFormat,t);m.value=n}else m.value="";if(Object.keys(t).length>0)if(e.triggers&&e.triggers.length>0){const t=e.triggers.find((e=>he(e,u,r)));t&&console.log(`Matched template trigger: ${t}`)}else console.log("No template triggers defined for this template");(0,se.vY)(),function(){const e=document.querySelector(".metadata-properties-header"),t=document.querySelector(".metadata-properties");e&&t&&(e.addEventListener("click",(()=>{const n=t.classList.toggle("collapsed");e.classList.toggle("collapsed"),de("propertiesCollapsed",n)})),ue("propertiesCollapsed").then((n=>{n?(t.classList.add("collapsed"),e.classList.add("collapsed")):(t.classList.remove("collapsed"),e.classList.remove("collapsed"))})))}();const f=document.getElementById("vault-select");if(f){if(e.vault)f.value=e.vault;else{const e=yield ue("lastSelectedVault");e&&o.includes(e)?f.value=e:o.length>0&&(f.value=o[0])}f.addEventListener("change",(()=>{de("lastSelectedVault",f.value)}))}}))}s.addEventListener("input",(function(){s.value=a(s.value),l(s)})),s.addEventListener("keydown",(function(e){"Enter"!==e.key||e.shiftKey||e.preventDefault()})),l(s),document.getElementById("clip-button").focus(),document.getElementById("clip-button").addEventListener("click",Ee),document.getElementById("open-settings").addEventListener("click",(function(){chrome.runtime.openOptionsPage()}));const d=yield(0,me.q5)(),u=document.getElementById("show-variables"),h=document.createElement("div");h.className="variables-panel",document.body.appendChild(h),u&&(u.style.display=d.showMoreActionsButton?"flex":"none",u.addEventListener("click",(function(){if(ge&&Object.keys(ye).length>0){const e=(0,le.f0)(ye);h.innerHTML=`\n\t\t\t\t\t<div class="variables-header">\n\t\t\t\t\t\t<h3>Page variables</h3>\n\t\t\t\t\t\t<span class="close-panel clickable-icon" aria-label="Close">\n\t\t\t\t\t\t\t<i data-lucide="x"></i>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="variable-list">${e}</div>\n\t\t\t\t`,h.classList.add("show"),(0,se.vY)(),h.querySelectorAll(".variable-item").forEach((e=>{const t=e.querySelector(".variable-key"),n=e.querySelector(".chevron-icon"),r=e.querySelector(".variable-value");r.scrollWidth>r.clientWidth&&e.classList.add("has-overflow"),t.addEventListener("click",(function(){const e=this.getAttribute("data-variable");e&&navigator.clipboard.writeText(e).then((()=>{const e=this.textContent;this.textContent="Copied!",setTimeout((()=>{this.textContent=e}),1e3)})).catch((e=>{console.error("Failed to copy text: ",e)}))})),n.addEventListener("click",(function(){e.classList.toggle("is-collapsed");const t=this.querySelector("i");t&&(t.setAttribute("data-lucide",e.classList.contains("is-collapsed")?"chevron-right":"chevron-down"),(0,se.vY)())}))})),h.querySelector(".close-panel").addEventListener("click",(function(){h.classList.remove("show")}))}else console.log("No variables available to display")})))}))}));